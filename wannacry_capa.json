{"meta":{"timestamp":"2024-12-01T20:50:42.184076","version":"7.4.0","argv":["-j","../Ransomware.WannaCry/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa.exe"],"sample":{"md5":"84c82835a5d21bbcf75a61706d8ab549","sha1":"5ff465afaabcbf0150d1a3ab2c2e74f3a4426467","sha256":"ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa","path":"/home/zz/Downloads/Ransomware.WannaCry/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa.exe"},"flavor":"static","analysis":{"format":"pe","arch":"i386","os":"windows","extractor":"VivisectFeatureExtractor","rules":["/tmp/_MEIISJwhZ/rules"],"base_address":{"type":"absolute","value":4194304},"layout":{"functions":[{"address":{"type":"absolute","value":4198400},"matched_basic_blocks":[{"address":{"type":"absolute","value":4198422}},{"address":{"type":"absolute","value":4198477}}]},{"address":{"type":"absolute","value":4198500},"matched_basic_blocks":[{"address":{"type":"absolute","value":4198500}},{"address":{"type":"absolute","value":4198583}}]},{"address":{"type":"absolute","value":4198653},"matched_basic_blocks":[{"address":{"type":"absolute","value":4198766}},{"address":{"type":"absolute","value":4198778}},{"address":{"type":"absolute","value":4198925}}]},{"address":{"type":"absolute","value":4198949},"matched_basic_blocks":[{"address":{"type":"absolute","value":4199072}},{"address":{"type":"absolute","value":4199104}},{"address":{"type":"absolute","value":4199126}},{"address":{"type":"absolute","value":4199133}}]},{"address":{"type":"absolute","value":4199590},"matched_basic_blocks":[{"address":{"type":"absolute","value":4199590}},{"address":{"type":"absolute","value":4199780}}]},{"address":{"type":"absolute","value":4200475},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200475}}]},{"address":{"type":"absolute","value":4200492},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200531}}]},{"address":{"type":"absolute","value":4200545},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200592}}]},{"address":{"type":"absolute","value":4200697},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200697}}]},{"address":{"type":"absolute","value":4200929},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200989}}]},{"address":{"type":"absolute","value":4201206},"matched_basic_blocks":[{"address":{"type":"absolute","value":4201259}},{"address":{"type":"absolute","value":4201282}}]},{"address":{"type":"absolute","value":4201311},"matched_basic_blocks":[{"address":{"type":"absolute","value":4201311}},{"address":{"type":"absolute","value":4201499}},{"address":{"type":"absolute","value":4201536}},{"address":{"type":"absolute","value":4201586}},{"address":{"type":"absolute","value":4201669}}]},{"address":{"type":"absolute","value":4201704},"matched_basic_blocks":[{"address":{"type":"absolute","value":4201704}},{"address":{"type":"absolute","value":4201797}}]},{"address":{"type":"absolute","value":4201899},"matched_basic_blocks":[{"address":{"type":"absolute","value":4201962}},{"address":{"type":"absolute","value":4201998}},{"address":{"type":"absolute","value":4202049}},{"address":{"type":"absolute","value":4202087}},{"address":{"type":"absolute","value":4202105}}]},{"address":{"type":"absolute","value":4202142},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202192}}]},{"address":{"type":"absolute","value":4202239},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202239}},{"address":{"type":"absolute","value":4202278}},{"address":{"type":"absolute","value":4202299}}]},{"address":{"type":"absolute","value":4202333},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202427}}]},{"address":{"type":"absolute","value":4202471},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202471}},{"address":{"type":"absolute","value":4202593}},{"address":{"type":"absolute","value":4202676}}]},{"address":{"type":"absolute","value":4202862},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202862}}]},{"address":{"type":"absolute","value":4202941},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202941}}]},{"address":{"type":"absolute","value":4202985},"matched_basic_blocks":[{"address":{"type":"absolute","value":4203044}},{"address":{"type":"absolute","value":4203071}},{"address":{"type":"absolute","value":4203100}},{"address":{"type":"absolute","value":4203128}},{"address":{"type":"absolute","value":4203132}},{"address":{"type":"absolute","value":4203142}},{"address":{"type":"absolute","value":4203167}},{"address":{"type":"absolute","value":4203229}},{"address":{"type":"absolute","value":4203255}},{"address":{"type":"absolute","value":4203302}},{"address":{"type":"absolute","value":4203404}},{"address":{"type":"absolute","value":4203552}},{"address":{"type":"absolute","value":4203590}}]},{"address":{"type":"absolute","value":4203632},"matched_basic_blocks":[{"address":{"type":"absolute","value":4203632}},{"address":{"type":"absolute","value":4203673}},{"address":{"type":"absolute","value":4203692}},{"address":{"type":"absolute","value":4203720}},{"address":{"type":"absolute","value":4203743}},{"address":{"type":"absolute","value":4203763}},{"address":{"type":"absolute","value":4203794}},{"address":{"type":"absolute","value":4203818}}]},{"address":{"type":"absolute","value":4203851},"matched_basic_blocks":[{"address":{"type":"absolute","value":4203851}},{"address":{"type":"absolute","value":4203967}},{"address":{"type":"absolute","value":4204049}},{"address":{"type":"absolute","value":4204057}}]},{"address":{"type":"absolute","value":4204155},"matched_basic_blocks":[{"address":{"type":"absolute","value":4204226}},{"address":{"type":"absolute","value":4204290}},{"address":{"type":"absolute","value":4204293}}]},{"address":{"type":"absolute","value":4204317},"matched_basic_blocks":[{"address":{"type":"absolute","value":4204317}},{"address":{"type":"absolute","value":4204358}}]},{"address":{"type":"absolute","value":4204376},"matched_basic_blocks":[{"address":{"type":"absolute","value":4204376}},{"address":{"type":"absolute","value":4204409}},{"address":{"type":"absolute","value":4204463}},{"address":{"type":"absolute","value":4204476}},{"address":{"type":"absolute","value":4204494}}]},{"address":{"type":"absolute","value":4204511},"matched_basic_blocks":[{"address":{"type":"absolute","value":4204511}},{"address":{"type":"absolute","value":4204554}},{"address":{"type":"absolute","value":4204592}},{"address":{"type":"absolute","value":4204665}},{"address":{"type":"absolute","value":4204678}},{"address":{"type":"absolute","value":4204712}},{"address":{"type":"absolute","value":4204723}},{"address":{"type":"absolute","value":4204739}},{"address":{"type":"absolute","value":4204758}}]},{"address":{"type":"absolute","value":4204836},"matched_basic_blocks":[{"address":{"type":"absolute","value":4204836}},{"address":{"type":"absolute","value":4204864}},{"address":{"type":"absolute","value":4204907}},{"address":{"type":"absolute","value":4204929}},{"address":{"type":"absolute","value":4204949}},{"address":{"type":"absolute","value":4204991}}]},{"address":{"type":"absolute","value":4205004},"matched_basic_blocks":[{"address":{"type":"absolute","value":4205021}},{"address":{"type":"absolute","value":4205092}}]},{"address":{"type":"absolute","value":4205174},"matched_basic_blocks":[{"address":{"type":"absolute","value":4205174}},{"address":{"type":"absolute","value":4205331}},{"address":{"type":"absolute","value":4205409}},{"address":{"type":"absolute","value":4205444}},{"address":{"type":"absolute","value":4205507}},{"address":{"type":"absolute","value":4205548}},{"address":{"type":"absolute","value":4205607}},{"address":{"type":"absolute","value":4205669}},{"address":{"type":"absolute","value":4205861}},{"address":{"type":"absolute","value":4205883}},{"address":{"type":"absolute","value":4205980}},{"address":{"type":"absolute","value":4206010}},{"address":{"type":"absolute","value":4206117}},{"address":{"type":"absolute","value":4206177}}]},{"address":{"type":"absolute","value":4206206},"matched_basic_blocks":[{"address":{"type":"absolute","value":4206206}},{"address":{"type":"absolute","value":4206421}},{"address":{"type":"absolute","value":4206431}}]},{"address":{"type":"absolute","value":4207036},"matched_basic_blocks":[{"address":{"type":"absolute","value":4207036}},{"address":{"type":"absolute","value":4207276}}]},{"address":{"type":"absolute","value":4207887},"matched_basic_blocks":[{"address":{"type":"absolute","value":4207887}},{"address":{"type":"absolute","value":4207961}},{"address":{"type":"absolute","value":4208038}},{"address":{"type":"absolute","value":4208159}},{"address":{"type":"absolute","value":4208277}},{"address":{"type":"absolute","value":4208370}}]},{"address":{"type":"absolute","value":4208535},"matched_basic_blocks":[{"address":{"type":"absolute","value":4208535}},{"address":{"type":"absolute","value":4208609}},{"address":{"type":"absolute","value":4208689}},{"address":{"type":"absolute","value":4208813}},{"address":{"type":"absolute","value":4208931}},{"address":{"type":"absolute","value":4209024}}]},{"address":{"type":"absolute","value":4209192},"matched_basic_blocks":[{"address":{"type":"absolute","value":4209192}},{"address":{"type":"absolute","value":4209250}}]},{"address":{"type":"absolute","value":4209271},"matched_basic_blocks":[{"address":{"type":"absolute","value":4209271}},{"address":{"type":"absolute","value":4209370}},{"address":{"type":"absolute","value":4209448}},{"address":{"type":"absolute","value":4209474}},{"address":{"type":"absolute","value":4209555}}]},{"address":{"type":"absolute","value":4209622},"matched_basic_blocks":[{"address":{"type":"absolute","value":4209657}},{"address":{"type":"absolute","value":4209682}},{"address":{"type":"absolute","value":4209697}},{"address":{"type":"absolute","value":4209717}},{"address":{"type":"absolute","value":4209760}},{"address":{"type":"absolute","value":4209788}},{"address":{"type":"absolute","value":4209803}},{"address":{"type":"absolute","value":4209823}}]},{"address":{"type":"absolute","value":4209864},"matched_basic_blocks":[{"address":{"type":"absolute","value":4209864}}]},{"address":{"type":"absolute","value":4209916},"matched_basic_blocks":[{"address":{"type":"absolute","value":4209916}},{"address":{"type":"absolute","value":4210019}},{"address":{"type":"absolute","value":4210133}},{"address":{"type":"absolute","value":4210191}},{"address":{"type":"absolute","value":4210221}},{"address":{"type":"absolute","value":4210288}},{"address":{"type":"absolute","value":4210350}},{"address":{"type":"absolute","value":4210380}},{"address":{"type":"absolute","value":4210441}},{"address":{"type":"absolute","value":4210471}},{"address":{"type":"absolute","value":4210580}},{"address":{"type":"absolute","value":4210610}},{"address":{"type":"absolute","value":4210640}},{"address":{"type":"absolute","value":4210663}},{"address":{"type":"absolute","value":4210738}},{"address":{"type":"absolute","value":4210927}},{"address":{"type":"absolute","value":4211070}},{"address":{"type":"absolute","value":4211143}},{"address":{"type":"absolute","value":4211182}},{"address":{"type":"absolute","value":4211206}},{"address":{"type":"absolute","value":4211248}},{"address":{"type":"absolute","value":4211285}},{"address":{"type":"absolute","value":4211320}}]},{"address":{"type":"absolute","value":4211392},"matched_basic_blocks":[{"address":{"type":"absolute","value":4211481}}]},{"address":{"type":"absolute","value":4211499},"matched_basic_blocks":[{"address":{"type":"absolute","value":4211499}},{"address":{"type":"absolute","value":4211525}},{"address":{"type":"absolute","value":4211559}},{"address":{"type":"absolute","value":4211582}},{"address":{"type":"absolute","value":4211605}}]},{"address":{"type":"absolute","value":4211638},"matched_basic_blocks":[{"address":{"type":"absolute","value":4211638}},{"address":{"type":"absolute","value":4211743}},{"address":{"type":"absolute","value":4211824}},{"address":{"type":"absolute","value":4211950}},{"address":{"type":"absolute","value":4212018}},{"address":{"type":"absolute","value":4212085}},{"address":{"type":"absolute","value":4212214}},{"address":{"type":"absolute","value":4212285}},{"address":{"type":"absolute","value":4212354}},{"address":{"type":"absolute","value":4212408}},{"address":{"type":"absolute","value":4212440}},{"address":{"type":"absolute","value":4212464}},{"address":{"type":"absolute","value":4212541}},{"address":{"type":"absolute","value":4212640}},{"address":{"type":"absolute","value":4212738}},{"address":{"type":"absolute","value":4212777}},{"address":{"type":"absolute","value":4212802}},{"address":{"type":"absolute","value":4212914}},{"address":{"type":"absolute","value":4212996}},{"address":{"type":"absolute","value":4213045}},{"address":{"type":"absolute","value":4213186}},{"address":{"type":"absolute","value":4213221}},{"address":{"type":"absolute","value":4213236}},{"address":{"type":"absolute","value":4213288}},{"address":{"type":"absolute","value":4213352}},{"address":{"type":"absolute","value":4213396}},{"address":{"type":"absolute","value":4213491}},{"address":{"type":"absolute","value":4213532}},{"address":{"type":"absolute","value":4213578}},{"address":{"type":"absolute","value":4213608}},{"address":{"type":"absolute","value":4213653}}]},{"address":{"type":"absolute","value":4213733},"matched_basic_blocks":[{"address":{"type":"absolute","value":4213733}}]},{"address":{"type":"absolute","value":4213785},"matched_basic_blocks":[{"address":{"type":"absolute","value":4213855}},{"address":{"type":"absolute","value":4213913}},{"address":{"type":"absolute","value":4213942}},{"address":{"type":"absolute","value":4213984}},{"address":{"type":"absolute","value":4213994}},{"address":{"type":"absolute","value":4214018}},{"address":{"type":"absolute","value":4214035}},{"address":{"type":"absolute","value":4214057}},{"address":{"type":"absolute","value":4214190}},{"address":{"type":"absolute","value":4214204}},{"address":{"type":"absolute","value":4214232}},{"address":{"type":"absolute","value":4214250}},{"address":{"type":"absolute","value":4214272}},{"address":{"type":"absolute","value":4214426}},{"address":{"type":"absolute","value":4214463}},{"address":{"type":"absolute","value":4214483}},{"address":{"type":"absolute","value":4214507}},{"address":{"type":"absolute","value":4214511}},{"address":{"type":"absolute","value":4214539}},{"address":{"type":"absolute","value":4214639}}]},{"address":{"type":"absolute","value":4214688},"matched_basic_blocks":[{"address":{"type":"absolute","value":4214688}},{"address":{"type":"absolute","value":4214725}}]},{"address":{"type":"absolute","value":4214815},"matched_basic_blocks":[{"address":{"type":"absolute","value":4214815}},{"address":{"type":"absolute","value":4214858}},{"address":{"type":"absolute","value":4214917}}]},{"address":{"type":"absolute","value":4215117},"matched_basic_blocks":[{"address":{"type":"absolute","value":4215117}},{"address":{"type":"absolute","value":4215209}},{"address":{"type":"absolute","value":4215289}},{"address":{"type":"absolute","value":4215315}},{"address":{"type":"absolute","value":4215344}},{"address":{"type":"absolute","value":4215368}},{"address":{"type":"absolute","value":4215411}},{"address":{"type":"absolute","value":4215452}},{"address":{"type":"absolute","value":4215476}},{"address":{"type":"absolute","value":4215527}},{"address":{"type":"absolute","value":4215533}},{"address":{"type":"absolute","value":4215574}},{"address":{"type":"absolute","value":4215610}},{"address":{"type":"absolute","value":4215683}},{"address":{"type":"absolute","value":4215715}},{"address":{"type":"absolute","value":4215741}},{"address":{"type":"absolute","value":4215762}},{"address":{"type":"absolute","value":4215789}}]},{"address":{"type":"absolute","value":4215839},"matched_basic_blocks":[{"address":{"type":"absolute","value":4215882}},{"address":{"type":"absolute","value":4216084}}]},{"address":{"type":"absolute","value":4216117},"matched_basic_blocks":[{"address":{"type":"absolute","value":4216117}}]},{"address":{"type":"absolute","value":4216200},"matched_basic_blocks":[{"address":{"type":"absolute","value":4216200}}]},{"address":{"type":"absolute","value":4216227},"matched_basic_blocks":[{"address":{"type":"absolute","value":4216227}}]},{"address":{"type":"absolute","value":4216260},"matched_basic_blocks":[{"address":{"type":"absolute","value":4216318}},{"address":{"type":"absolute","value":4216330}},{"address":{"type":"absolute","value":4216344}},{"address":{"type":"absolute","value":4216485}}]},{"address":{"type":"absolute","value":4216570},"matched_basic_blocks":[{"address":{"type":"absolute","value":4216587}}]},{"address":{"type":"absolute","value":4216695},"matched_basic_blocks":[{"address":{"type":"absolute","value":4216770}},{"address":{"type":"absolute","value":4216790}}]},{"address":{"type":"absolute","value":4216892},"matched_basic_blocks":[{"address":{"type":"absolute","value":4217026}},{"address":{"type":"absolute","value":4217071}},{"address":{"type":"absolute","value":4217170}},{"address":{"type":"absolute","value":4217223}},{"address":{"type":"absolute","value":4217328}},{"address":{"type":"absolute","value":4217370}},{"address":{"type":"absolute","value":4217412}},{"address":{"type":"absolute","value":4217486}},{"address":{"type":"absolute","value":4217547}},{"address":{"type":"absolute","value":4217589}},{"address":{"type":"absolute","value":4217635}}]},{"address":{"type":"absolute","value":4217774},"matched_basic_blocks":[{"address":{"type":"absolute","value":4217789}},{"address":{"type":"absolute","value":4217830}},{"address":{"type":"absolute","value":4217835}},{"address":{"type":"absolute","value":4217926}}]},{"address":{"type":"absolute","value":4218126},"matched_basic_blocks":[{"address":{"type":"absolute","value":4218150}},{"address":{"type":"absolute","value":4218171}},{"address":{"type":"absolute","value":4218177}},{"address":{"type":"absolute","value":4218223}},{"address":{"type":"absolute","value":4218231}},{"address":{"type":"absolute","value":4218237}}]},{"address":{"type":"absolute","value":4218250},"matched_basic_blocks":[{"address":{"type":"absolute","value":4218319}}]},{"address":{"type":"absolute","value":4218351},"matched_basic_blocks":[{"address":{"type":"absolute","value":4218351}}]},{"address":{"type":"absolute","value":4218407},"matched_basic_blocks":[{"address":{"type":"absolute","value":4218451}}]},{"address":{"type":"absolute","value":4218475},"matched_basic_blocks":[{"address":{"type":"absolute","value":4218514}},{"address":{"type":"absolute","value":4218538}},{"address":{"type":"absolute","value":4218566}}]},{"address":{"type":"absolute","value":4218591},"matched_basic_blocks":[{"address":{"type":"absolute","value":4218591}},{"address":{"type":"absolute","value":4218701}},{"address":{"type":"absolute","value":4218719}},{"address":{"type":"absolute","value":4218736}},{"address":{"type":"absolute","value":4218754}},{"address":{"type":"absolute","value":4218811}}]},{"address":{"type":"absolute","value":4218850},"matched_basic_blocks":[{"address":{"type":"absolute","value":4218909}},{"address":{"type":"absolute","value":4219116}},{"address":{"type":"absolute","value":4219165}}]},{"address":{"type":"absolute","value":4219281},"matched_basic_blocks":[{"address":{"type":"absolute","value":4219281}}]},{"address":{"type":"absolute","value":4219360},"matched_basic_blocks":[{"address":{"type":"absolute","value":4219360}},{"address":{"type":"absolute","value":4219388}},{"address":{"type":"absolute","value":4219561}},{"address":{"type":"absolute","value":4219827}},{"address":{"type":"absolute","value":4219849}},{"address":{"type":"absolute","value":4219884}},{"address":{"type":"absolute","value":4219921}},{"address":{"type":"absolute","value":4219945}},{"address":{"type":"absolute","value":4219957}},{"address":{"type":"absolute","value":4219994}},{"address":{"type":"absolute","value":4220027}}]},{"address":{"type":"absolute","value":4220091},"matched_basic_blocks":[{"address":{"type":"absolute","value":4220091}}]},{"address":{"type":"absolute","value":4220130},"matched_basic_blocks":[{"address":{"type":"absolute","value":4220147}}]},{"address":{"type":"absolute","value":4220192},"matched_basic_blocks":[{"address":{"type":"absolute","value":4220227}}]},{"address":{"type":"absolute","value":4220282},"matched_basic_blocks":[{"address":{"type":"absolute","value":4220282}},{"address":{"type":"absolute","value":4220647}},{"address":{"type":"absolute","value":4220669}}]},{"address":{"type":"absolute","value":4220701},"matched_basic_blocks":[{"address":{"type":"absolute","value":4220701}},{"address":{"type":"absolute","value":4220740}}]},{"address":{"type":"absolute","value":4221056},"matched_basic_blocks":[{"address":{"type":"absolute","value":4221192}},{"address":{"type":"absolute","value":4221220}},{"address":{"type":"absolute","value":4221245}},{"address":{"type":"absolute","value":4221400}},{"address":{"type":"absolute","value":4221455}}]},{"address":{"type":"absolute","value":4221698},"matched_basic_blocks":[{"address":{"type":"absolute","value":4221698}}]},{"address":{"type":"absolute","value":4221731},"matched_basic_blocks":[{"address":{"type":"absolute","value":4221731}}]},{"address":{"type":"absolute","value":4221838},"matched_basic_blocks":[{"address":{"type":"absolute","value":4221952}},{"address":{"type":"absolute","value":4221982}}]},{"address":{"type":"absolute","value":4222016},"matched_basic_blocks":[{"address":{"type":"absolute","value":4222016}},{"address":{"type":"absolute","value":4222085}},{"address":{"type":"absolute","value":4222217}},{"address":{"type":"absolute","value":4222282}},{"address":{"type":"absolute","value":4222302}},{"address":{"type":"absolute","value":4222551}},{"address":{"type":"absolute","value":4222629}},{"address":{"type":"absolute","value":4222835}},{"address":{"type":"absolute","value":4222868}},{"address":{"type":"absolute","value":4222926}},{"address":{"type":"absolute","value":4223042}}]},{"address":{"type":"absolute","value":4223088},"matched_basic_blocks":[{"address":{"type":"absolute","value":4223106}},{"address":{"type":"absolute","value":4223167}},{"address":{"type":"absolute","value":4223234}}]},{"address":{"type":"absolute","value":4223286},"matched_basic_blocks":[{"address":{"type":"absolute","value":4223286}},{"address":{"type":"absolute","value":4223308}},{"address":{"type":"absolute","value":4223415}},{"address":{"type":"absolute","value":4223480}},{"address":{"type":"absolute","value":4223624}},{"address":{"type":"absolute","value":4223713}},{"address":{"type":"absolute","value":4223762}},{"address":{"type":"absolute","value":4223811}},{"address":{"type":"absolute","value":4223867}},{"address":{"type":"absolute","value":4223961}}]},{"address":{"type":"absolute","value":4224295},"matched_basic_blocks":[{"address":{"type":"absolute","value":4224334}}]},{"address":{"type":"absolute","value":4224429},"matched_basic_blocks":[{"address":{"type":"absolute","value":4224429}}]},{"address":{"type":"absolute","value":4224573},"matched_basic_blocks":[{"address":{"type":"absolute","value":4224573}}]}]},"feature_counts":{"file":44312,"functions":[{"address":{"type":"absolute","value":4198400},"count":38},{"address":{"type":"absolute","value":4198500},"count":44},{"address":{"type":"absolute","value":4198653},"count":71},{"address":{"type":"absolute","value":4198949},"count":78},{"address":{"type":"absolute","value":4199165},"count":48},{"address":{"type":"absolute","value":4199374},"count":45},{"address":{"type":"absolute","value":4199479},"count":52},{"address":{"type":"absolute","value":4199590},"count":81},{"address":{"type":"absolute","value":4200202},"count":34},{"address":{"type":"absolute","value":4200413},"count":29},{"address":{"type":"absolute","value":4200447},"count":20},{"address":{"type":"absolute","value":4200475},"count":22},{"address":{"type":"absolute","value":4200492},"count":44},{"address":{"type":"absolute","value":4200545},"count":35},{"address":{"type":"absolute","value":4200633},"count":30},{"address":{"type":"absolute","value":4200697},"count":51},{"address":{"type":"absolute","value":4200929},"count":43},{"address":{"type":"absolute","value":4201029},"count":32},{"address":{"type":"absolute","value":4201206},"count":47},{"address":{"type":"absolute","value":4201311},"count":67},{"address":{"type":"absolute","value":4201704},"count":48},{"address":{"type":"absolute","value":4201899},"count":58},{"address":{"type":"absolute","value":4202142},"count":38},{"address":{"type":"absolute","value":4202239},"count":47},{"address":{"type":"absolute","value":4202333},"count":36},{"address":{"type":"absolute","value":4202471},"count":77},{"address":{"type":"absolute","value":4202862},"count":12},{"address":{"type":"absolute","value":4202885},"count":11},{"address":{"type":"absolute","value":4202904},"count":12},{"address":{"type":"absolute","value":4202930},"count":11},{"address":{"type":"absolute","value":4202941},"count":20},{"address":{"type":"absolute","value":4202985},"count":138},{"address":{"type":"absolute","value":4203607},"count":23},{"address":{"type":"absolute","value":4203632},"count":77},{"address":{"type":"absolute","value":4203851},"count":66},{"address":{"type":"absolute","value":4204111},"count":26},{"address":{"type":"absolute","value":4204155},"count":75},{"address":{"type":"absolute","value":4204317},"count":34},{"address":{"type":"absolute","value":4204376},"count":62},{"address":{"type":"absolute","value":4204511},"count":88},{"address":{"type":"absolute","value":4204836},"count":60},{"address":{"type":"absolute","value":4205004},"count":46},{"address":{"type":"absolute","value":4205126},"count":17},{"address":{"type":"absolute","value":4205139},"count":20},{"address":{"type":"absolute","value":4205167},"count":12},{"address":{"type":"absolute","value":4205174},"count":164},{"address":{"type":"absolute","value":4206206},"count":128},{"address":{"type":"absolute","value":4207036},"count":129},{"address":{"type":"absolute","value":4207887},"count":140},{"address":{"type":"absolute","value":4208535},"count":142},{"address":{"type":"absolute","value":4209192},"count":49},{"address":{"type":"absolute","value":4209271},"count":56},{"address":{"type":"absolute","value":4209622},"count":50},{"address":{"type":"absolute","value":4209864},"count":37},{"address":{"type":"absolute","value":4209916},"count":136},{"address":{"type":"absolute","value":4211375},"count":19},{"address":{"type":"absolute","value":4211392},"count":57},{"address":{"type":"absolute","value":4211499},"count":51},{"address":{"type":"absolute","value":4211638},"count":191},{"address":{"type":"absolute","value":4213733},"count":23},{"address":{"type":"absolute","value":4213785},"count":112},{"address":{"type":"absolute","value":4214688},"count":52},{"address":{"type":"absolute","value":4214815},"count":65},{"address":{"type":"absolute","value":4215074},"count":25},{"address":{"type":"absolute","value":4215117},"count":97},{"address":{"type":"absolute","value":4215839},"count":48},{"address":{"type":"absolute","value":4216117},"count":45},{"address":{"type":"absolute","value":4216200},"count":22},{"address":{"type":"absolute","value":4216227},"count":15},{"address":{"type":"absolute","value":4216260},"count":93},{"address":{"type":"absolute","value":4216541},"count":12},{"address":{"type":"absolute","value":4216558},"count":12},{"address":{"type":"absolute","value":4216570},"count":38},{"address":{"type":"absolute","value":4216633},"count":37},{"address":{"type":"absolute","value":4216695},"count":62},{"address":{"type":"absolute","value":4216892},"count":114},{"address":{"type":"absolute","value":4217774},"count":69},{"address":{"type":"absolute","value":4218015},"count":33},{"address":{"type":"absolute","value":4218055},"count":26},{"address":{"type":"absolute","value":4218077},"count":30},{"address":{"type":"absolute","value":4218126},"count":46},{"address":{"type":"absolute","value":4218250},"count":50},{"address":{"type":"absolute","value":4218351},"count":30},{"address":{"type":"absolute","value":4218407},"count":28},{"address":{"type":"absolute","value":4218475},"count":32},{"address":{"type":"absolute","value":4218591},"count":80},{"address":{"type":"absolute","value":4218850},"count":51},{"address":{"type":"absolute","value":4219234},"count":31},{"address":{"type":"absolute","value":4219281},"count":65},{"address":{"type":"absolute","value":4219360},"count":58},{"address":{"type":"absolute","value":4220091},"count":15},{"address":{"type":"absolute","value":4220130},"count":39},{"address":{"type":"absolute","value":4220192},"count":52},{"address":{"type":"absolute","value":4220282},"count":52},{"address":{"type":"absolute","value":4220701},"count":139},{"address":{"type":"absolute","value":4221056},"count":108},{"address":{"type":"absolute","value":4221591},"count":49},{"address":{"type":"absolute","value":4221698},"count":30},{"address":{"type":"absolute","value":4221731},"count":52},{"address":{"type":"absolute","value":4221838},"count":71},{"address":{"type":"absolute","value":4222016},"count":161},{"address":{"type":"absolute","value":4223088},"count":54},{"address":{"type":"absolute","value":4223286},"count":118},{"address":{"type":"absolute","value":4224123},"count":27},{"address":{"type":"absolute","value":4224164},"count":40},{"address":{"type":"absolute","value":4224295},"count":38},{"address":{"type":"absolute","value":4224370},"count":28},{"address":{"type":"absolute","value":4224429},"count":17},{"address":{"type":"absolute","value":4224452},"count":36},{"address":{"type":"absolute","value":4224515},"count":30},{"address":{"type":"absolute","value":4224573},"count":18},{"address":{"type":"absolute","value":4224598},"count":33},{"address":{"type":"absolute","value":4224680},"count":7},{"address":{"type":"absolute","value":4224686},"count":7},{"address":{"type":"absolute","value":4224692},"count":7},{"address":{"type":"absolute","value":4224744},"count":7},{"address":{"type":"absolute","value":4224750},"count":7},{"address":{"type":"absolute","value":4224762},"count":7},{"address":{"type":"absolute","value":4224768},"count":7},{"address":{"type":"absolute","value":4224774},"count":7},{"address":{"type":"absolute","value":4224832},"count":7},{"address":{"type":"absolute","value":4224844},"count":21},{"address":{"type":"absolute","value":4224878},"count":6},{"address":{"type":"absolute","value":4224948},"count":7},{"address":{"type":"absolute","value":4225304},"count":7},{"address":{"type":"absolute","value":4225310},"count":7},{"address":{"type":"absolute","value":4225316},"count":7},{"address":{"type":"absolute","value":4225340},"count":6},{"address":{"type":"absolute","value":4225343},"count":6},{"address":{"type":"absolute","value":4225344},"count":7}]},"library_functions":[{"address":{"type":"absolute","value":4199262},"name":"??_GCDatabase@@UAEPAXI@Z"},{"address":{"type":"absolute","value":4199290},"name":"??1CDatabase@@UAE@XZ"},{"address":{"type":"absolute","value":4202915},"name":"__beep"},{"address":{"type":"absolute","value":4224712},"name":"__EH_prolog"},{"address":{"type":"absolute","value":4224896},"name":"__allmul"},{"address":{"type":"absolute","value":4224954},"name":"_WinMainCRTStartup"},{"address":{"type":"absolute","value":4225322},"name":"__setdefaultprecision"}]}},"rules":{"link function at runtime on Windows":{"meta":{"name":"link function at runtime on Windows","namespace":"linking/runtime-linking","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com"],"scopes":{"static":"instruction","dynamic":"call"},"attack":[{"parts":["Execution","Shared Modules"],"tactic":"Execution","technique":"Shared Modules","subtechnique":"","id":"T1129"}],"mbc":[],"references":[],"examples":["9324D1A8AE37A36AE560C37448C9705A:0x404130","Practical Malware Analysis Lab 01-04.exe_:0x401350"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: instruction\n      dynamic: call\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n","matches":[[{"type":"absolute","value":4200265},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4200265}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4200278},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4200278}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4200291},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4200291}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4200304},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4200304}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4200317},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4200317}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4200330},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4200330}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4200343},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4200343}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201079},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4201079}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201092},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4201092}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201105},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4201105}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201118},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4201118}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201131},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4201131}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201144},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4201144}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"calculate modulo 256 via x86 assembly":{"meta":{"name":"calculate modulo 256 via x86 assembly","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"instruction"},"attack":[],"mbc":[{"parts":["Data","Modulo"],"objective":"Data","behavior":"Modulo","method":"","id":"C0058"}],"references":[],"examples":["9324D1A8AE37A36AE560C37448C9705A:0x4049A9"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: instruction\n      dynamic: unsupported  # requires mnemonic features\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - or:\n        - arch: i386\n        - arch: amd64\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n","matches":[[{"type":"absolute","value":4205783},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4205783}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4205783}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4205938},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4205938}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4205938}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4206150},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4206150}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4206150}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208202},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4208202}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4208202}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208498},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4208498}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4208498}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208856},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4208856}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4208856}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209155},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4209155}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4209155}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"create or open file":{"meta":{"name":"create or open file","authors":["michael.hunhoff@mandiant.com","joakim@intezer.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["File System","Create File"],"objective":"File System","behavior":"Create File","method":"","id":"C0016"}],"references":[],"examples":["B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n","matches":[[{"type":"absolute","value":4198422},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"fopen"}},"children":[],"locations":[{"type":"absolute","value":4198427}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fdopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"freopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"open"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"openat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4199590},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateFile"}},"children":[],"locations":[{"type":"absolute","value":4199693}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fdopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"freopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"open"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"openat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4200697},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateFile"}},"children":[],"locations":[{"type":"absolute","value":4200762}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fdopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"freopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"open"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"openat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4217835},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateFile"}},"children":[],"locations":[{"type":"absolute","value":4217854}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fdopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"freopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"open"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"openat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223762},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateFile"}},"children":[],"locations":[{"type":"absolute","value":4223787}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fdopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"freopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"open"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"openat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"create process on Windows":{"meta":{"name":"create process on Windows","namespace":"host-interaction/process/create","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Process","Create Process"],"objective":"Process","behavior":"Create Process","method":"","id":"C0017"}],"references":[],"examples":["9324D1A8AE37A36AE560C37448C9705A:0x406DB0","Practical Malware Analysis Lab 01-04.exe_:0x4011FC","692f7fd6d198e804d6af98eb9e390d61:0x6000003"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n","matches":[[{"type":"absolute","value":4198500},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WinExec"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcess"}},"children":[],"locations":[{"type":"absolute","value":4198568}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ShellExecute"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ShellExecuteEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessAsUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessWithLogon"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessWithToken"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessInternal"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateUserProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateProcessEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateProcessEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateUserProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateUserProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::Start"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"delay execution":{"meta":{"name":"delay execution","authors":["michael.hunhoff@mandiant.com","@ramen0x3f"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Anti-Behavioral Analysis","Dynamic Analysis Evasion","Delayed Execution"],"objective":"Anti-Behavioral Analysis","behavior":"Dynamic Analysis Evasion","method":"Delayed Execution","id":"B0003.003"}],"references":["https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions","https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"],"examples":["al-khaser_x86.exe_:0x449770","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - or:\n          - api: sleep\n          - api: usleep\n","matches":[[{"type":"absolute","value":4198583},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[{"type":"absolute","value":4198589}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4202299},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[{"type":"absolute","value":4202304}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"create or open registry key":{"meta":{"name":"create or open registry key","authors":["michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Operating System","Registry","Create Registry Key"],"objective":"Operating System","behavior":"Registry","method":"Create Registry Key","id":"C0036.004"},{"parts":["Operating System","Registry","Open Registry Key"],"objective":"Operating System","behavior":"Registry","method":"Open Registry Key","id":"C0036.003"}],"references":[],"examples":["Practical Malware Analysis Lab 03-02.dll_:0x10004706","Practical Malware Analysis Lab 11-01.exe_:0x401000","493167E85E45363D09495D0841C30648:0x404D60","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E","692f7fd6d198e804d6af98eb9e390d61:0x6000003"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: create or open registry key\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n","matches":[[{"type":"absolute","value":4198766},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[{"type":"absolute","value":4198771}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4198778},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[{"type":"absolute","value":4198778}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get file attributes":{"meta":{"name":"get file attributes","namespace":"host-interaction/file-system/meta","authors":["michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["File System","Get File Attributes"],"objective":"File System","behavior":"Get File Attributes","method":"","id":"C0049"}],"references":[],"examples":["03B236B23B1EC37C663527C1F53AF3FE:0x180019824","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: get file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Get File Attributes [C0049]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x180019824\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0\n  features:\n    - or:\n      - api: kernel32.GetFileAttributes\n      - api: ZwQueryDirectoryFile\n      - api: ZwQueryInformationFile\n      - api: NtQueryDirectoryFile\n      - api: NtQueryInformationFile\n      - api: System.IO.File::GetAttributes\n      - api: System.IO.File::GetCreationTime\n      - api: System.IO.File::GetCreationTimeUtc\n      - api: System.IO.File::GetLastAccessTime\n      - api: System.IO.File::GetLastAccessTimeUtc\n      - api: System.IO.File::GetLastWriteTime\n      - api: System.IO.File::GetLastWriteTimeUtc\n      - property/read: System.IO.FileSystemInfo::Attributes\n      - api: stat\n      - api: fstat\n      - api: lstat\n      - api: fstatat\n","matches":[[{"type":"absolute","value":4201259},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4201260}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryDirectoryFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryDirectoryFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetAttributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetCreationTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetCreationTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastAccessTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastAccessTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastWriteTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastWriteTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.IO.FileSystemInfo::Attributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"stat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fstat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"lstat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fstatat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201311},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4201488}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryDirectoryFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryDirectoryFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetAttributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetCreationTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetCreationTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastAccessTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastAccessTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastWriteTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastWriteTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.IO.FileSystemInfo::Attributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"stat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fstat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"lstat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fstatat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4202087},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4202094}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryDirectoryFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryDirectoryFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetAttributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetCreationTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetCreationTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastAccessTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastAccessTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastWriteTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastWriteTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.IO.FileSystemInfo::Attributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"stat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fstat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"lstat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fstatat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4202593},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4202614}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryDirectoryFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryDirectoryFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetAttributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetCreationTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetCreationTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastAccessTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastAccessTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastWriteTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastWriteTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.IO.FileSystemInfo::Attributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"stat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fstat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"lstat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fstatat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223106},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4223107}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryDirectoryFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryDirectoryFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetAttributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetCreationTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetCreationTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastAccessTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastAccessTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastWriteTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastWriteTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.IO.FileSystemInfo::Attributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"stat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fstat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"lstat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fstatat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223234},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4223256}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryDirectoryFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryDirectoryFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetAttributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetCreationTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetCreationTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastAccessTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastAccessTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastWriteTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastWriteTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.IO.FileSystemInfo::Attributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"stat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fstat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"lstat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fstatat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"set file attributes":{"meta":{"name":"set file attributes","namespace":"host-interaction/file-system/meta","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[{"parts":["Defense Evasion","File and Directory Permissions Modification"],"tactic":"Defense Evasion","technique":"File and Directory Permissions Modification","subtechnique":"","id":"T1222"}],"mbc":[{"parts":["File System","Set File Attributes"],"objective":"File System","behavior":"Set File Attributes","method":"","id":"C0050"}],"references":[],"examples":["946A99F36A46D335DEC080D9A4371940:0x100015f0","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: set file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    att&ck:\n      - Defense Evasion::File and Directory Permissions Modification [T1222]\n    mbc:\n      - File System::Set File Attributes [C0050]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015f0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n  features:\n    - or:\n      - api: kernel32.SetFileAttributes\n      - api: ZwSetInformationFile\n      - api: NtSetInformationFile\n      - api: System.IO.File::SetAttributes\n      - api: System.IO.File::SetCreationTime\n      - api: System.IO.File::SetCreationTimeUtc\n      - api: System.IO.File::SetLastAccessTime\n      - api: System.IO.File::SetLastAccessTimeUtc\n      - api: System.IO.File::SetLastWriteTime\n      - api: System.IO.File::SetLastWriteTimeUtc\n      - property/write: System.IO.FileSystemInfo::Attributes\n      - api: utime\n      - api: utimes\n","matches":[[{"type":"absolute","value":4201259},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"SetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4201270}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwSetInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtSetInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetAttributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetCreationTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetCreationTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetLastAccessTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetLastAccessTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetLastWriteTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetLastWriteTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"write","property":"System.IO.FileSystemInfo::Attributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"utime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"utimes"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"check mutex":{"meta":{"name":"check mutex","namespace":"host-interaction/mutex","authors":["moritz.raabe@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"basic block","dynamic":"thread"},"attack":[],"mbc":[{"parts":["Process","Check Mutex"],"objective":"Process","behavior":"Check Mutex","method":"","id":"C0043"}],"references":[],"examples":["Practical Malware Analysis Lab 01-01.dll_:0x10001010"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: check mutex\n    namespace: host-interaction/mutex\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: thread\n    mbc:\n      - Process::Check Mutex [C0043]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - and:\n      - or:\n        - api: kernel32.OpenMutex\n        - match: create mutex\n        - api: System.Threading.Mutex::OpenExisting\n        - api: System.Threading.Mutex::TryOpenExisting\n      - optional:\n        - or:\n          - api: kernel32.GetLastError\n          - number: 2 = ERROR_FILE_NOT_FOUND\n          - number: 0xB7 = ERROR_ALREADY_EXISTS\n","matches":[[{"type":"absolute","value":4202278},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenMutex"}},"children":[],"locations":[{"type":"absolute","value":4202289}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"create mutex"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Mutex::OpenExisting"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Mutex::TryOpenExisting"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetLastError"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2,"description":"ERROR_FILE_NOT_FOUND"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":183,"description":"ERROR_ALREADY_EXISTS"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"allocate memory":{"meta":{"name":"allocate memory","authors":["0x534a@mailbox.org","@mr-tz"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Memory","Allocate Memory"],"objective":"Memory","behavior":"Allocate Memory","method":"","id":"C0007"}],"references":[],"examples":["Practical Malware Analysis Lab 03-03.exe_:0x4010EA","563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: allocate memory\n    authors:\n      - 0x534a@mailbox.org\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA  # ntdll.NtAllocateVirtualMemory\n  features:\n    - or:\n      - api: kernel32.VirtualAlloc\n      - api: kernel32.VirtualAllocEx\n      - api: kernel32.VirtualAllocExNuma\n      - api: NtAllocateVirtualMemory\n      - api: ZwAllocateVirtualMemory\n      - api: NtMapViewOfSection\n      - api: ZwMapViewOfSection\n      - and:\n        - match: link function at runtime on Windows\n        - or:\n          - string: \"VirtualAlloc\"\n          - string: \"VirtualAllocEx\"\n          - string: \"VirtualAllocExNuma\"\n          - string: \"NtAllocateVirtualMemory\"\n          - string: \"ZwAllocateVirtualMemory\"\n          - string: \"NtMapViewOfSection\"\n          - string: \"ZwMapViewOfSection\"\n","matches":[[{"type":"absolute","value":4202862},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[{"type":"absolute","value":4202878}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"link function at runtime on Windows"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"string","string":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"string","string":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"string","string":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"string","string":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"string","string":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"string","string":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"string","string":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"change memory protection":{"meta":{"name":"change memory protection","authors":["@mr-tz"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Memory","Change Memory Protection"],"objective":"Memory","behavior":"Change Memory Protection","method":"","id":"C0008"}],"references":[],"examples":["Practical Malware Analysis Lab 11-02.dll_:0x10001203"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: change memory protection\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Memory::Change Memory Protection [C0008]\n    examples:\n      - Practical Malware Analysis Lab 11-02.dll_:0x10001203\n  features:\n    - or:\n      - api: kernel32.VirtualProtect\n      - api: kernel32.VirtualProtectEx\n      - api: NtProtectVirtualMemory\n      - api: ZwProtectVirtualMemory\n      - and:\n        - match: link function at runtime on Windows\n        - or:\n          - string: \"VirtualProtect\"\n          - string: \"VirtualProtectEx\"\n          - string: \"NtProtectVirtualMemory\"\n          - string: \"ZwProtectVirtualMemory\"\n","matches":[[{"type":"absolute","value":4204293},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualProtect"}},"children":[],"locations":[{"type":"absolute","value":4204301}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualProtectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtProtectVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwProtectVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"link function at runtime on Windows"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"string","string":"VirtualProtect"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"string","string":"VirtualProtectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"string","string":"NtProtectVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"string","string":"ZwProtectVirtualMemory"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"encode data using XOR":{"meta":{"name":"encode data using XOR","namespace":"data-manipulation/encoding/xor","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"basic block"},"attack":[{"parts":["Defense Evasion","Obfuscated Files or Information"],"tactic":"Defense Evasion","technique":"Obfuscated Files or Information","subtechnique":"","id":"T1027"}],"mbc":[{"parts":["Defense Evasion","Obfuscated Files or Information","Encoding-Standard Algorithm"],"objective":"Defense Evasion","behavior":"Obfuscated Files or Information","method":"Encoding-Standard Algorithm","id":"E1027.m02"},{"parts":["Data","Encode Data","XOR"],"objective":"Data","behavior":"Encode Data","method":"XOR","id":"C0026.002"}],"references":[],"examples":["2D3EDC218A90F03089CC01715A9F047F:0x403D7E"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: encode data using XOR\n    namespace: data-manipulation/encoding/xor\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, Not features\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]\n      - Data::Encode Data::XOR [C0026.002]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403D7E\n  features:\n    - and:\n      - characteristic: tight loop\n      - characteristic: nzxor\n      - not:\n        - description: filter for potential false positives\n        - or:\n          - or:\n            - description: unsigned bitwise negation operation (~i)\n            - number: 0xFFFFFFFF = bitwise negation for unsigned 32 bits\n            - number: 0xFFFFFFFFFFFFFFFF = bitwise negation for unsigned 64 bits\n          - or:\n            - description: signed bitwise negation operation (~i)\n            - number: 0x0FFFFFFF = bitwise negation for signed 32 bits\n            - number: 0x0FFFFFFFFFFFFFFF = bitwise negation for signed 64 bits\n          - or:\n            - description: Magic constants used in the implementation of strings functions.\n            # such as `strlen` and `strcat` in the Windows standard library:\n            # (((i - 0x81010101) ^ ~i) & 0x81010100)\n            ## 32 bits\n            - number: 0x7EFEFEFF = optimized string constant for 32 bits\n            - number: 0x81010101 = -0x81010101 = 0x7EFEFEFF\n            - number: 0x81010100 = 0x81010100 = ~0x7EFEFEFF\n            ## 64 bits\n            - number: 0x7EFEFEFEFEFEFEFF = optimized string constant for 64 bits\n            - number: 0x8101010101010101 = -0x8101010101010101 = 0x7EFEFEFEFEFEFEFF\n            - number: 0x8101010101010100 = 0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF\n","matches":[[{"type":"absolute","value":4205861},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4205861}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4205864}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4205883},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4205883}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4205886}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4205980},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4205980}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4205983}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4206117},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4206117}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4206155},{"type":"absolute","value":4206139},{"type":"absolute","value":4206162}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4206431},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4206431}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4206657},{"type":"absolute","value":4206530},{"type":"absolute","value":4206501},{"type":"absolute","value":4206565},{"type":"absolute","value":4206629},{"type":"absolute","value":4206476},{"type":"absolute","value":4206604},{"type":"absolute","value":4206543},{"type":"absolute","value":4206577},{"type":"absolute","value":4206450},{"type":"absolute","value":4206644},{"type":"absolute","value":4206517},{"type":"absolute","value":4206486},{"type":"absolute","value":4206617},{"type":"absolute","value":4206588},{"type":"absolute","value":4206462}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207276},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4207276}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4207456},{"type":"absolute","value":4207395},{"type":"absolute","value":4207427},{"type":"absolute","value":4207334},{"type":"absolute","value":4207496},{"type":"absolute","value":4207369},{"type":"absolute","value":4207307},{"type":"absolute","value":4207471},{"type":"absolute","value":4207344},{"type":"absolute","value":4207410},{"type":"absolute","value":4207381},{"type":"absolute","value":4207417},{"type":"absolute","value":4207322},{"type":"absolute","value":4207357},{"type":"absolute","value":4207486},{"type":"absolute","value":4207295}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208038},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4208038}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4208083}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208159},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4208159}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4208248},{"type":"absolute","value":4208262},{"type":"absolute","value":4208236},{"type":"absolute","value":4208214}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208370},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4208370}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4208509},{"type":"absolute","value":4208413},{"type":"absolute","value":4208478},{"type":"absolute","value":4208447}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208689},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4208689}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4208734}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208813},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4208813}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4208890},{"type":"absolute","value":4208868},{"type":"absolute","value":4208916},{"type":"absolute","value":4208902}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209024},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4209024}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4209104},{"type":"absolute","value":4209166},{"type":"absolute","value":4209070},{"type":"absolute","value":4209135}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209250},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4209250}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4209252}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4215882},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4215882}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4216032},{"type":"absolute","value":4216002},{"type":"absolute","value":4215907},{"type":"absolute","value":4215940},{"type":"absolute","value":4216067},{"type":"absolute","value":4216009},{"type":"absolute","value":4215979},{"type":"absolute","value":4215917},{"type":"absolute","value":4216048},{"type":"absolute","value":4215986},{"type":"absolute","value":4215956},{"type":"absolute","value":4215893},{"type":"absolute","value":4216055},{"type":"absolute","value":4216025},{"type":"absolute","value":4215963},{"type":"absolute","value":4215933}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4216084},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4216084}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4216091},{"type":"absolute","value":4216103}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not","description":"filter for potential false positives"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"unsigned bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"bitwise negation for unsigned 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":18446744073709551615,"description":"bitwise negation for unsigned 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"signed bitwise negation operation (~i)"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":268435455,"description":"bitwise negation for signed 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1152921504606846975,"description":"bitwise negation for signed 64 bits"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or","description":"Magic constants used in the implementation of strings functions."}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2130640639,"description":"optimized string constant for 32 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326657,"description":"-0x81010101 = 0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2164326656,"description":"0x81010100 = ~0x7EFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9151031864016699135,"description":"optimized string constant for 64 bits"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852481,"description":"-0x8101010101010101 = 0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":9295712209692852480,"description":"0x8101010101010100 = ~0x7EFEFEFEFEFEFEFF"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"generate random numbers using the Delphi LCG":{"meta":{"name":"generate random numbers using the Delphi LCG","namespace":"data-manipulation/prng/lcg","authors":["william.ballenthin@mandiant.com"],"scopes":{"static":"basic block"},"attack":[],"mbc":[{"parts":["Cryptography","Generate Pseudo-random Sequence"],"objective":"Cryptography","behavior":"Generate Pseudo-random Sequence","method":"","id":"C0021"}],"references":["https://en.wikipedia.org/wiki/Linear_congruential_generator","https://community.osr.com/discussion/130410/generating-random-numbers"],"examples":[],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: generate random numbers using the Delphi LCG\n    namespace: data-manipulation/prng/lcg\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires mnemonic features\n    mbc:\n      - Cryptography::Generate Pseudo-random Sequence [C0021]\n    references:\n      - https://en.wikipedia.org/wiki/Linear_congruential_generator\n      - https://community.osr.com/discussion/130410/generating-random-numbers\n  features:\n    - and:\n      - instruction:\n        - mnemonic: imul\n        - number: 0x8088405 = multiplier a\n      - mnemonic: inc = increment c\n","matches":[[{"type":"absolute","value":4216117},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"instruction"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"imul"}},"children":[],"locations":[{"type":"absolute","value":4216167}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":134775813,"description":"multiplier a"}},"children":[],"locations":[{"type":"absolute","value":4216167}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4216167}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"inc","description":"increment c"}},"children":[],"locations":[{"type":"absolute","value":4216173}],"captures":{}}],"locations":[],"captures":{}}]]},"read file on Windows":{"meta":{"name":"read file on Windows","namespace":"host-interaction/file-system/read","authors":["moritz.raabe@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"thread"},"attack":[],"mbc":[{"parts":["File System","Read File"],"objective":"File System","behavior":"Read File","method":"","id":"C0051"}],"references":[],"examples":["BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: read file on Windows\n    namespace: host-interaction/file-system/read\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Read File [C0051]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x1314567B\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - and:\n            - number: 0x80000000 = GENERIC_READ\n            - match: create or open file\n        - or:\n          - api: kernel32.ReadFile\n          - api: ReadFileEx\n          - api: NtReadFile\n          - api: ZwReadFile\n          - api: LZRead\n          - api: _read\n          - api: fread\n      - api: System.IO.File::ReadAllBytes\n      - api: System.IO.File::ReadAllBytesAsync\n      - api: System.IO.File::ReadAllLines\n      - api: System.IO.File::ReadAllLinesAsync\n      - api: System.IO.File::ReadAllText\n      - api: System.IO.File::ReadAllTextAsync\n      - api: System.IO.File::ReadLines\n","matches":[[{"type":"absolute","value":4198400},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllBytes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllBytesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllLines"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllLinesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllText"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllTextAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadLines"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483648,"description":"GENERIC_READ"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create or open file"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"fopen"}},"children":[],"locations":[{"type":"absolute","value":4198427}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fdopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"freopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"open"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"openat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4198422}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ReadFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ReadFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtReadFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwReadFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZRead"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_read"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"fread"}},"children":[],"locations":[{"type":"absolute","value":4198463}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4200697},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllBytes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllBytesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllLines"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllLinesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllText"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllTextAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadLines"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483648,"description":"GENERIC_READ"}},"children":[],"locations":[{"type":"absolute","value":4200754}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create or open file"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateFile"}},"children":[],"locations":[{"type":"absolute","value":4200762}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fdopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"freopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"open"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"openat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4200697}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"ReadFile"}},"children":[],"locations":[{"type":"absolute","value":4200829}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ReadFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtReadFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwReadFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZRead"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_read"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218250},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllBytes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllBytesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllLines"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllLinesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllText"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadAllTextAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::ReadLines"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483648,"description":"GENERIC_READ"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"create or open file"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"ReadFile"}},"children":[],"locations":[{"type":"absolute","value":4218283}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ReadFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtReadFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwReadFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZRead"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_read"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"write file on Windows":{"meta":{"name":"write file on Windows","namespace":"host-interaction/file-system/write","authors":["william.ballenthin@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"thread"},"attack":[],"mbc":[{"parts":["File System","Writes File"],"objective":"File System","behavior":"Writes File","method":"","id":"C0052"}],"references":[],"examples":["Practical Malware Analysis Lab 01-04.exe_:0x4011FC","563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: write file on Windows\n    namespace: host-interaction/file-system/write\n    authors:\n      - william.ballenthin@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Writes File [C0052]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x1400025C4\n  features:\n    - or:\n      - and:\n        - os: windows\n        - optional:\n          - basic block:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n          - call:\n            - or:\n              - number: 0x40000000 = GENERIC_WRITE\n              - number: 0x2 = FILE_WRITE_DATA\n              - match: create or open file\n        - or:\n          - api: kernel32.WriteFile\n          - api: kernel32.WriteFileEx\n          - api: NtWriteFile\n          - api: ZwWriteFile\n          - api: _fwrite\n          - api: fwrite\n      - api: System.IO.File::WriteAllBytes\n      - api: System.IO.File::WriteAllBytesAsync\n      - api: System.IO.File::WriteAllLines\n      - api: System.IO.File::WriteAllLinesAsync\n      - api: System.IO.File::WriteAllText\n      - api: System.IO.File::WriteAllTextAsync\n      - api: System.IO.File::AppendAllLines\n      - api: System.IO.File::AppendAllLinesAsync\n      - api: System.IO.File::AppendAllText\n      - api: System.IO.File::AppendAllTextAsync\n      - api: System.IO.File::AppendText\n      - api: System.IO.FileInfo::AppendText\n","matches":[[{"type":"absolute","value":4198400},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllBytes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllBytesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllLines"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllLinesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllText"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllTextAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendAllLines"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendAllLinesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendAllText"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendAllTextAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendText"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.FileInfo::AppendText"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1073741824,"description":"GENERIC_WRITE"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2,"description":"FILE_WRITE_DATA"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create or open file"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"fopen"}},"children":[],"locations":[{"type":"absolute","value":4198427}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fdopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"freopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"open"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"openat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4198422}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4198422}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"write file on Windows/0833e45a1159458f87513f08b73aeb21"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WriteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WriteFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWriteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwWriteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_fwrite"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"fwrite"}},"children":[],"locations":[{"type":"absolute","value":4198471}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223286},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllBytes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllBytesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllLines"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllLinesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllText"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::WriteAllTextAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendAllLines"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendAllLinesAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendAllText"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendAllTextAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::AppendText"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.FileInfo::AppendText"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":1073741824,"description":"GENERIC_WRITE"}},"children":[],"locations":[{"type":"absolute","value":4223781}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2,"description":"FILE_WRITE_DATA"}},"children":[],"locations":[{"type":"absolute","value":4223771}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create or open file"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateFile"}},"children":[],"locations":[{"type":"absolute","value":4223787}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fdopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"freopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"open"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"openat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4223762}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1073741824,"description":"GENERIC_WRITE"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2,"description":"FILE_WRITE_DATA"}},"children":[],"locations":[{"type":"absolute","value":4223308}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"create or open file"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4223762},{"type":"absolute","value":4223308}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"write file on Windows/0833e45a1159458f87513f08b73aeb21"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WriteFile"}},"children":[],"locations":[{"type":"absolute","value":4224011}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WriteFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWriteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwWriteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_fwrite"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fwrite"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"terminate process":{"meta":{"name":"terminate process","namespace":"host-interaction/process/terminate","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"thread"},"attack":[],"mbc":[{"parts":["Process","Terminate Process"],"objective":"Process","behavior":"Terminate Process","method":"","id":"C0018"}],"references":[],"examples":["C91887D861D9BD4A5872249B641BC9F9:0x401A77","9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n","matches":[[{"type":"absolute","value":4198500},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::Kill"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::WaitForExit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::WaitForExitAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::Exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Windows.Forms.Application::Exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Exit"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"open process"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"TerminateProcess"}},"children":[],"locations":[{"type":"absolute","value":4198604}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtTerminateProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ExitProcess"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"query or enumerate registry value":{"meta":{"name":"query or enumerate registry value","namespace":"host-interaction/registry","authors":["william.ballenthin@mandiant.com","michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"thread"},"attack":[{"parts":["Discovery","Query Registry"],"tactic":"Discovery","technique":"Query Registry","subtechnique":"","id":"T1012"}],"mbc":[{"parts":["Operating System","Registry","Query Registry Value"],"objective":"Operating System","behavior":"Registry","method":"Query Registry Value","id":"C0036.006"}],"references":[],"examples":["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A","Practical Malware Analysis Lab 03-02.dll_:0x100047AD"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n        - api: Microsoft.Win32.RegistryKey::GetValueKind\n        - api: Microsoft.Win32.RegistryKey::GetValueNames\n        - api: Microsoft.Win32.Registry::GetValue\n","matches":[[{"type":"absolute","value":4198653},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create or open registry key"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[{"type":"absolute","value":4198778}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[{"type":"absolute","value":4198771}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4198778},{"type":"absolute","value":4198766}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegGetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegEnumValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegQueryValue"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegQueryValueEx"}},"children":[],"locations":[{"type":"absolute","value":4198884}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegQueryMultipleValues"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwEnumerateValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtEnumerateValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlQueryRegistryValues"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHEnumValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegGetInt"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegGetPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegGetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHQueryValueEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegGetUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHOpenRegStream"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegEnumUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHOpenRegStream2"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegQueryUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegGetBoolUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegGetValueFromHKCUHKLM"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegGetBoolValueFromHKCUHKLM"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::GetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::GetValueKind"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::GetValueNames"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.Registry::GetValue"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"set registry value":{"meta":{"name":"set registry value","namespace":"host-interaction/registry/create","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"thread"},"attack":[],"mbc":[{"parts":["Operating System","Registry","Set Registry Key"],"objective":"Operating System","behavior":"Registry","method":"Set Registry Key","id":"C0036.001"}],"references":[],"examples":["BFB9B5391A13D0AFD787E87AB90F14F5:0x13147AF0","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40415E","98c37c3c23bbfb362dac7754c6ba48e75cf24d73bc963a4cdfca557b9e016909:0x40294D"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: set registry value\n    namespace: host-interaction/registry/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Operating System::Registry::Set Registry Key [C0036.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13147AF0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40415E\n      - 98c37c3c23bbfb362dac7754c6ba48e75cf24d73bc963a4cdfca557b9e016909:0x40294D\n  features:\n    - or:\n      - and:\n        - optional:\n          - match: create or open registry key\n        - or:\n          - api: advapi32.RegSetValue\n          - api: advapi32.RegSetValueEx\n          - api: advapi32.RegSetKeyValue\n          - api: ZwSetValueKey\n          - api: NtSetValueKey\n          - api: RtlWriteRegistryValue\n          - api: SHSetValue\n          - api: SHRegSetPath\n          - api: SHRegSetValue\n          - api: SHRegSetUSValue\n          - api: SHRegWriteUSValue\n          - api: Microsoft.Win32.RegistryKey::SetValue\n          - api: Microsoft.Win32.Registry::SetValue\n      - and:\n        - match: host-interaction/process/create\n        - string: \"/add/i\"\n        - or:\n          - string: \"/reg(|.exe)/i\"\n          - string: \"/hklm/i\"\n          - string: \"/HKEY_LOCAL_MACHINE/i\"\n          - string: \"/hkcu/i\"\n          - string: \"/HKEY_CURRENT_USER/i\"\n","matches":[[{"type":"absolute","value":4198653},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"host-interaction/process/create"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/add/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/reg(|.exe)/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/hklm/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HKEY_LOCAL_MACHINE/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/hkcu/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HKEY_CURRENT_USER/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create or open registry key"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[{"type":"absolute","value":4198778}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[{"type":"absolute","value":4198771}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4198778},{"type":"absolute","value":4198766}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegSetValue"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegSetValueEx"}},"children":[],"locations":[{"type":"absolute","value":4198845}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegSetKeyValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwSetValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtSetValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlWriteRegistryValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHSetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegWriteUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::SetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.Registry::SetValue"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"contain loop":{"meta":{"name":"contain loop","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function"},"attack":[],"mbc":[],"references":[],"examples":["08AC667C65D36D6542917655571E61C8:0x406EAA"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n","matches":[[{"type":"absolute","value":4198653},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4198653}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4198949},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4198949}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4199104},{"type":"absolute","value":4199046}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4199374},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4199418},{"type":"absolute","value":4199450}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4200492},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4200492}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201899},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4201899}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4202239},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4202239}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4202985},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4202985}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4203632},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4203632}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4203851},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4203851}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4204317},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4204317}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4204376},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4204376}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4204511},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4204511}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4204836},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4204836}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4205004},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4205004}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4205174},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4205174}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4205861},{"type":"absolute","value":4206117},{"type":"absolute","value":4205607},{"type":"absolute","value":4205883},{"type":"absolute","value":4205980}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4206206},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4206431}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207036},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4207276}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207887},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4207887}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4208370},{"type":"absolute","value":4208038},{"type":"absolute","value":4208159}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208535},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4208535}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4209024},{"type":"absolute","value":4208689},{"type":"absolute","value":4208813}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209192},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4209250}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209271},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4209370},{"type":"absolute","value":4209555},{"type":"absolute","value":4209474}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209916},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4209916}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4210663}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4211638},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4211638}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4212894}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4213785},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4213785}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4214539},{"type":"absolute","value":4214035},{"type":"absolute","value":4213855}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4215117},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4215117}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4215627},{"type":"absolute","value":4215591},{"type":"absolute","value":4215561},{"type":"absolute","value":4215546},{"type":"absolute","value":4215527}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4215839},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4215882},{"type":"absolute","value":4216084}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4216260},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4216260}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4216344},{"type":"absolute","value":4216485}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218591},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4218591}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4220701},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4220701}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221056},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4221056}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4221273},{"type":"absolute","value":4221383}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4222016},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4222016}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223088},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4223088}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[{"type":"absolute","value":4223088}],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223286},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4223286}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"set current directory":{"meta":{"name":"set current directory","namespace":"host-interaction/file-system","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[],"references":[],"examples":[],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: set current directory\n    namespace: host-interaction/file-system\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n  features:\n    - or:\n      - api: System.IO.Directory::SetCurrentDirectory\n      - api: kernel32.SetCurrentDirectory\n      - api: chdir\n      - api: fchdir\n","matches":[[{"type":"absolute","value":4198653},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.Directory::SetCurrentDirectory"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"SetCurrentDirectory"}},"children":[],"locations":[{"type":"absolute","value":4198906}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"chdir"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fchdir"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201206},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.Directory::SetCurrentDirectory"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"SetCurrentDirectory"}},"children":[],"locations":[{"type":"absolute","value":4201249},{"type":"absolute","value":4201234}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"chdir"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fchdir"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4202471},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.Directory::SetCurrentDirectory"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"SetCurrentDirectory"}},"children":[],"locations":[{"type":"absolute","value":4202683}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"chdir"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fchdir"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get common file path":{"meta":{"name":"get common file path","namespace":"host-interaction/file-system","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[{"parts":["Discovery","File and Directory Discovery"],"tactic":"Discovery","technique":"File and Directory Discovery","subtechnique":"","id":"T1083"}],"mbc":[{"parts":["Discovery","File and Directory Discovery"],"objective":"Discovery","behavior":"File and Directory Discovery","method":"","id":"E1083"}],"references":[],"examples":["Practical Malware Analysis Lab 03-02.dll_:0x10003415","972B219F18379907A045431303F4DA7D:0x404887"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetKnownFolderPath\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n","matches":[[{"type":"absolute","value":4198653},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetTempPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetTempFileName"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetSystemDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetWindowsDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetSystemWow64Directory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetAllUsersProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetAppContainerFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetCurrentDirectory"}},"children":[],"locations":[{"type":"absolute","value":4198810}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetDefaultUserProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetProfilesDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetUserProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderPathAndSubDir"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderLocation"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetKnownFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetSpecialFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetSpecialFolderLocation"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.Directory::GetCurrentDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::GetFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::SystemDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::CurrentDirectory"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201311},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetTempPath"}},"children":[],"locations":[{"type":"absolute","value":4201623}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetTempFileName"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetSystemDirectory"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetWindowsDirectory"}},"children":[],"locations":[{"type":"absolute","value":4201437}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetSystemWow64Directory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetAllUsersProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetAppContainerFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetCurrentDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetDefaultUserProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetProfilesDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetUserProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderPathAndSubDir"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderLocation"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetKnownFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetSpecialFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetSpecialFolderLocation"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.Directory::GetCurrentDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::GetFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::SystemDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::CurrentDirectory"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221838},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetTempPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetTempFileName"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetSystemDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetWindowsDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetSystemWow64Directory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetAllUsersProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetAppContainerFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetCurrentDirectory"}},"children":[],"locations":[{"type":"absolute","value":4221877}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetDefaultUserProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetProfilesDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetUserProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderPathAndSubDir"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderLocation"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetKnownFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetSpecialFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetSpecialFolderLocation"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.Directory::GetCurrentDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::GetFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::SystemDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::CurrentDirectory"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get hostname":{"meta":{"name":"get hostname","namespace":"host-interaction/os/hostname","authors":["moritz.raabe@mandiant.com","joakim@intezer.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[{"parts":["Discovery","System Information Discovery"],"tactic":"Discovery","technique":"System Information Discovery","subtechnique":"","id":"T1082"}],"mbc":[{"parts":["Discovery","System Information Discovery"],"objective":"Discovery","behavior":"System Information Discovery","method":"","id":"E1082"}],"references":[],"examples":["9324D1A8AE37A36AE560C37448C9705A:0x4052A0","7351f8a40c5450557b24622417fc478d:0x405438"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n","matches":[[{"type":"absolute","value":4198949},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetComputerName"}},"children":[],"locations":[{"type":"absolute","value":4199007}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetComputerNameEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetComputerObjectName"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"gethostname"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::MachineName"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get file size":{"meta":{"name":"get file size","namespace":"host-interaction/file-system/meta","authors":["michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[{"parts":["Discovery","File and Directory Discovery"],"tactic":"Discovery","technique":"File and Directory Discovery","subtechnique":"","id":"T1083"}],"mbc":[{"parts":["Discovery","File and Directory Discovery"],"objective":"Discovery","behavior":"File and Directory Discovery","method":"","id":"E1083"}],"references":[],"examples":["mimikatz.exe_:0x40630D"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: get file size\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - mimikatz.exe_:0x40630D\n  features:\n    - or:\n      - api: kernel32.GetFileSize\n      - api: kernel32.GetFileSizeEx\n      - property/read: System.IO.FileInfo::Length\n","matches":[[{"type":"absolute","value":4199590},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetFileSize"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetFileSizeEx"}},"children":[],"locations":[{"type":"absolute","value":4199721}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.IO.FileInfo::Length"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4200697},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetFileSize"}},"children":[],"locations":[{"type":"absolute","value":4200778}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetFileSizeEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.IO.FileInfo::Length"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"link many functions at runtime":{"meta":{"name":"link many functions at runtime","namespace":"linking/runtime-linking","authors":["moritz.raabe@mandiant.com","joakim@intezer.com"],"scopes":{"static":"function","dynamic":"thread"},"attack":[{"parts":["Execution","Shared Modules"],"tactic":"Execution","technique":"Shared Modules","subtechnique":"","id":"T1129"}],"mbc":[],"references":[],"examples":["b7b5e1253710d8927cbe07d52d2d2e10:0x401000"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: link many functions at runtime\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - b7b5e1253710d8927cbe07d52d2d2e10:0x401000\n  features:\n    - or:\n      - and:\n        - os: windows\n        - match: link function at runtime on Windows\n        - or:\n          - count(api(kernel32.GetProcAddress)): 5 or more\n          - count(api(ntdll.LdrGetProcedureAddress)): 5 or more\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - match: link function at runtime on Linux\n        - or:\n          - count(api(dlsym)): 5 or more\n          - count(api(dlvsym)): 5 or more\n","matches":[[{"type":"absolute","value":4200202},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"link function at runtime on Windows"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4200304}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4200291}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4200278}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4200343}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4200265}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4200330}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4200317}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4200304},{"type":"absolute","value":4200291},{"type":"absolute","value":4200278},{"type":"absolute","value":4200343},{"type":"absolute","value":4200265},{"type":"absolute","value":4200330},{"type":"absolute","value":4200317}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"range","min":5,"max":9223372036854775808,"child":{"type":"api","api":"GetProcAddress"}}},"children":[],"locations":[{"type":"absolute","value":4200304},{"type":"absolute","value":4200291},{"type":"absolute","value":4200278},{"type":"absolute","value":4200343},{"type":"absolute","value":4200265},{"type":"absolute","value":4200330},{"type":"absolute","value":4200317}],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"range","min":5,"max":9223372036854775808,"child":{"type":"api","api":"LdrGetProcedureAddress"}}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"link function at runtime on Linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"range","min":5,"max":9223372036854775808,"child":{"type":"api","api":"dlsym"}}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"range","min":5,"max":9223372036854775808,"child":{"type":"api","api":"dlvsym"}}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201029},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"link function at runtime on Windows"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4201105}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4201092}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4201079}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4201144}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4201131}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4201118}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4201105},{"type":"absolute","value":4201092},{"type":"absolute","value":4201079},{"type":"absolute","value":4201144},{"type":"absolute","value":4201131},{"type":"absolute","value":4201118}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"range","min":5,"max":9223372036854775808,"child":{"type":"api","api":"GetProcAddress"}}},"children":[],"locations":[{"type":"absolute","value":4201105},{"type":"absolute","value":4201092},{"type":"absolute","value":4201079},{"type":"absolute","value":4201144},{"type":"absolute","value":4201131},{"type":"absolute","value":4201118}],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"range","min":5,"max":9223372036854775808,"child":{"type":"api","api":"LdrGetProcedureAddress"}}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"link function at runtime on Linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"range","min":5,"max":9223372036854775808,"child":{"type":"api","api":"dlsym"}}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"range","min":5,"max":9223372036854775808,"child":{"type":"api","api":"dlvsym"}}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"create directory":{"meta":{"name":"create directory","namespace":"host-interaction/file-system/create","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[{"parts":["File System","Create Directory"],"objective":"File System","behavior":"Create Directory","method":"","id":"C0046"}],"references":[],"examples":["Practical Malware Analysis Lab 17-02.dll_:0x10008f62","692f7fd6d198e804d6af98eb9e390d61:0x6000003"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: create directory\n    namespace: host-interaction/file-system/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - File System::Create Directory [C0046]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x10008f62\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.CreateDirectory\n      - api: kernel32.CreateDirectoryEx\n      - api: kernel32.CreateDirectoryTransacted\n      - api: NtCreateDirectoryObject\n      - api: ZwCreateDirectoryObject\n      - api: SHCreateDirectory\n      - api: SHCreateDirectoryEx\n      - api: mkdir\n      - api: _mkdir\n      - api: _wmkdir\n      - api: System.IO.Directory::CreateDirectory\n      - api: System.IO.DirectoryInfo::Create\n      - api: System.IO.DirectoryInfo::CreateSubdirectory\n","matches":[[{"type":"absolute","value":4201206},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateDirectory"}},"children":[],"locations":[{"type":"absolute","value":4201246},{"type":"absolute","value":4201223}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateDirectoryEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateDirectoryTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateDirectoryObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateDirectoryObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateDirectoryEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"mkdir"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_mkdir"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_wmkdir"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.Directory::CreateDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.DirectoryInfo::Create"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.DirectoryInfo::CreateSubdirectory"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223088},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateDirectory"}},"children":[],"locations":[{"type":"absolute","value":4223121},{"type":"absolute","value":4223276}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateDirectoryEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateDirectoryTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateDirectoryObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateDirectoryObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateDirectoryEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"mkdir"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_mkdir"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_wmkdir"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.Directory::CreateDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.DirectoryInfo::Create"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.DirectoryInfo::CreateSubdirectory"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"check if file exists":{"meta":{"name":"check if file exists","namespace":"host-interaction/file-system/exists","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[{"parts":["Discovery","File and Directory Discovery"],"tactic":"Discovery","technique":"File and Directory Discovery","subtechnique":"","id":"T1083"}],"mbc":[{"parts":["Discovery","File and Directory Discovery"],"objective":"Discovery","behavior":"File and Directory Discovery","method":"","id":"E1083"}],"references":[],"examples":["31600AD0D1A7EA615690DF111AE36C73:0x401284"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: check if file exists\n    namespace: host-interaction/file-system/exists\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401284\n  features:\n    - or:\n      - basic block:\n        - and:\n          - api: kernel32.GetFileAttributes\n          - instruction:\n            - mnemonic: cmp\n            - number: 0xFFFFFFFF = INVALID_FILE_ATTRIBUTES\n      - basic block:\n        - and:\n          - api: kernel32.GetLastError\n          - instruction:\n            - mnemonic: cmp\n            - number: 2 = ERROR_FILE_NOT_FOUND\n      - api: shlwapi.PathFileExists\n      - api: System.IO.File::Exists\n      - property/read: System.IO.FileSystemInfo::Exists\n","matches":[[{"type":"absolute","value":4201311},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4201488}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"instruction"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"cmp"}},"children":[],"locations":[{"type":"absolute","value":4201494}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"INVALID_FILE_ATTRIBUTES"}},"children":[],"locations":[{"type":"absolute","value":4201494}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4201494}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4201311}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"check if file exists/7a381703979a4f6eb17ded6944360489"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"PathFileExists"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::Exists"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.IO.FileSystemInfo::Exists"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201899},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4202094}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"instruction"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"cmp"}},"children":[],"locations":[{"type":"absolute","value":4202100}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"INVALID_FILE_ATTRIBUTES"}},"children":[],"locations":[{"type":"absolute","value":4202100}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4202100}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4202087}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"check if file exists/7a381703979a4f6eb17ded6944360489"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"PathFileExists"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::Exists"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.IO.FileSystemInfo::Exists"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4202471},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4202614}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"instruction"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"cmp"}},"children":[],"locations":[{"type":"absolute","value":4202620}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"INVALID_FILE_ATTRIBUTES"}},"children":[],"locations":[{"type":"absolute","value":4202620}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4202620}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4202593}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"check if file exists/7a381703979a4f6eb17ded6944360489"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"PathFileExists"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::Exists"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.IO.FileSystemInfo::Exists"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223088},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4223107}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"instruction"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"cmp"}},"children":[],"locations":[{"type":"absolute","value":4223113}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"INVALID_FILE_ATTRIBUTES"}},"children":[],"locations":[{"type":"absolute","value":4223113}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4223113}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4223256}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"instruction"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"cmp"}},"children":[],"locations":[{"type":"absolute","value":4223262}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":4294967295,"description":"INVALID_FILE_ATTRIBUTES"}},"children":[],"locations":[{"type":"absolute","value":4223262}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4223262}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4223106},{"type":"absolute","value":4223234}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"check if file exists/7a381703979a4f6eb17ded6944360489"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"PathFileExists"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::Exists"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.IO.FileSystemInfo::Exists"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"persist via Windows service":{"meta":{"name":"persist via Windows service","namespace":"persistence/service","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function","dynamic":"thread"},"attack":[{"parts":["Persistence","Create or Modify System Process","Windows Service"],"tactic":"Persistence","technique":"Create or Modify System Process","subtechnique":"Windows Service","id":"T1543.003"},{"parts":["Execution","System Services","Service Execution"],"tactic":"Execution","technique":"System Services","subtechnique":"Service Execution","id":"T1569.002"}],"mbc":[],"references":[],"examples":["Practical Malware Analysis Lab 03-02.dll_:0x10004706","9f012d7e3ae8f62370278e372691eb73b878fe2280b6083e1be637b278021855:0x40113A"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: persist via Windows service\n    namespace: persistence/service\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - 9f012d7e3ae8f62370278e372691eb73b878fe2280b6083e1be637b278021855:0x40113A\n  features:\n    - or:\n      - and:\n        - or:\n          - basic block:\n            - and:\n              - number: 2 = SERVICE_AUTO_START\n              - api: advapi32.CreateService\n          - call:\n            - and:\n              - number: 2 = SERVICE_AUTO_START\n              - api: advapi32.CreateService\n        - optional:\n          - or:\n            - api: advapi32.OpenService\n            - api: advapi32.StartService\n      - and:\n        - match: host-interaction/process/create\n        - or:\n          - and:\n            - string: /^sc(|\\.exe)$/i\n            - string: /create /i\n          - string: /^sc(|\\.exe) create/i\n          - string: /New-Service /i\n      - and:\n        - match: \"set registry value\"\n        - string: /System\\\\(CurrentControlSet|ControlSet001)\\\\Services/i\n","matches":[[{"type":"absolute","value":4201704},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"set registry value"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/System\\\\(CurrentControlSet|ControlSet001)\\\\Services/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2,"description":"SERVICE_AUTO_START"}},"children":[],"locations":[{"type":"absolute","value":4201835}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateService"}},"children":[],"locations":[{"type":"absolute","value":4201845}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4201797}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"persist via Windows service/4f3d14110de743109bd45e49c2e72a3f"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenService"}},"children":[],"locations":[{"type":"absolute","value":4201761}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"StartService"}},"children":[],"locations":[{"type":"absolute","value":4201777},{"type":"absolute","value":4201860}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"host-interaction/process/create"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/^sc(|\\.exe)$/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/create /i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/^sc(|\\.exe) create/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/New-Service /i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get service handle":{"meta":{"name":"get service handle","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[],"references":[],"examples":["Practical Malware Analysis Lab 03-02.dll_:0x10004706"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: get service handle\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: call\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n  features:\n    - or:\n      - api: advapi32.CreateService\n      - api: advapi32.OpenService\n","matches":[[{"type":"absolute","value":4201704},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateService"}},"children":[],"locations":[{"type":"absolute","value":4201845}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenService"}},"children":[],"locations":[{"type":"absolute","value":4201761}],"captures":{}}],"locations":[],"captures":{}}]]},"start service":{"meta":{"name":"start service","namespace":"host-interaction/service/start","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function","dynamic":"thread"},"attack":[{"parts":["Persistence","Create or Modify System Process","Windows Service"],"tactic":"Persistence","technique":"Create or Modify System Process","subtechnique":"Windows Service","id":"T1543.003"}],"mbc":[],"references":[],"examples":["E544A4D616B60147D9774B48C2B65EF2:0x401FA0"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: start service\n    namespace: host-interaction/service/start\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n    examples:\n      - E544A4D616B60147D9774B48C2B65EF2:0x401FA0\n  features:\n    - and:\n      - optional:\n        - match: get service handle\n      - api: advapi32.StartService\n","matches":[[{"type":"absolute","value":4201704},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"StartService"}},"children":[],"locations":[{"type":"absolute","value":4201777},{"type":"absolute","value":4201860}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"get service handle"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateService"}},"children":[],"locations":[{"type":"absolute","value":4201845}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenService"}},"children":[],"locations":[{"type":"absolute","value":4201761}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4201704}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"create service":{"meta":{"name":"create service","namespace":"host-interaction/service/create","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function","dynamic":"thread"},"attack":[{"parts":["Persistence","Create or Modify System Process","Windows Service"],"tactic":"Persistence","technique":"Create or Modify System Process","subtechnique":"Windows Service","id":"T1543.003"},{"parts":["Execution","System Services","Service Execution"],"tactic":"Execution","technique":"System Services","subtechnique":"Service Execution","id":"T1569.002"}],"mbc":[],"references":[],"examples":["Practical Malware Analysis Lab 03-02.dll_:0x10004706"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: create service\n    namespace: host-interaction/service/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    att&ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n  features:\n    - and:\n      - api: advapi32.CreateService\n      - optional:\n        - api: advapi32.OpenSCManager\n","matches":[[{"type":"absolute","value":4201704},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateService"}},"children":[],"locations":[{"type":"absolute","value":4201845}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenSCManager"}},"children":[],"locations":[{"type":"absolute","value":4201726}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"extract resource via kernel32 functions":{"meta":{"name":"extract resource via kernel32 functions","namespace":"executable/resource","authors":["william.ballenthin@mandiant.com"],"scopes":{"static":"function","dynamic":"thread"},"attack":[],"mbc":[],"references":[],"examples":["BF88E1BD4A3BDE10B419A622278F1FF7:0x401000","Practical Malware Analysis Lab 01-04.exe_:0x4011FC","563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: extract resource via kernel32 functions\n    namespace: executable/resource\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    examples:\n      - BF88E1BD4A3BDE10B419A622278F1FF7:0x401000\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.LoadResource\n          - api: kernel32.LockResource\n          - api: LdrAccessResource\n        - optional:\n          - api: kernel32.GetModuleHandle\n          # may occur in parent function, see 0664B09A86EC2DF7DFE01A93E184A1FA23DF66EA82CAB39000944E418EC1F7B2\n          - or:\n            - api: kernel32.FindResource\n            - api: kernel32.FindResourceEx\n            - api: LdrFindResource_U\n            - api: LdrFindResourceEx_U\n          - api: kernel32.SizeofResource\n          - api: kernel32.FreeResource\n","matches":[[{"type":"absolute","value":4201899},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"LoadResource"}},"children":[],"locations":[{"type":"absolute","value":4201939}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"LockResource"}},"children":[],"locations":[{"type":"absolute","value":4201950}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrAccessResource"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetModuleHandle"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"FindResource"}},"children":[],"locations":[{"type":"absolute","value":4201923}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"FindResourceEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrFindResource_U"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrFindResourceEx_U"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"SizeofResource"}},"children":[],"locations":[{"type":"absolute","value":4201969}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"FreeResource"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"copy file":{"meta":{"name":"copy file","namespace":"host-interaction/file-system/copy","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"thread"},"attack":[],"mbc":[{"parts":["File System","Copy File"],"objective":"File System","behavior":"Copy File","method":"","id":"C0045"}],"references":[],"examples":["Practical Malware Analysis Lab 01-01.exe_:0x401440"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: copy file\n    namespace: host-interaction/file-system/copy\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - File System::Copy File [C0045]\n    examples:\n      - Practical Malware Analysis Lab 01-01.exe_:0x401440\n  features:\n    - or:\n      - api: kernel32.CopyFile\n      - api: kernel32.CopyFileEx\n      - api: CopyFile2\n      - api: CopyFileTransacted\n      - api: LZCopy\n      - api: System.IO.FileInfo::CopyTo\n      - api: System.IO.File::Copy\n      - basic block:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n","matches":[[{"type":"absolute","value":4202471},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CopyFile"}},"children":[],"locations":[{"type":"absolute","value":4202607}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CopyFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CopyFile2"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CopyFileTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZCopy"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.FileInfo::CopyTo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::Copy"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"copy file/2d96e6154ade4f44a5cc81b5a04fb8d8"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"copy file/5058c350ee2e473aa15a475525e07d42"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"enumerate PE sections":{"meta":{"name":"enumerate PE sections","namespace":"load-code/pe","authors":["@Ana06","@mr-tz"],"scopes":{"static":"function"},"attack":[],"mbc":[{"parts":["Discovery","Code Discovery","Enumerate PE Sections"],"objective":"Discovery","behavior":"Code Discovery","method":"Enumerate PE Sections","id":"B0046.001"}],"references":["https://0x00sec.org/t/reflective-dll-injection/3080","https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection"],"examples":["E4C33AC3638EEF68311F8AC0D72483C7:0x401510"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: enumerate PE sections\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n      - \"@mr-tz\"\n    scopes:\n      static: function\n      dynamic: unsupported  # requires offset, operand[1].offset, characteristic, mnemonic, basicblock features\n    mbc:\n      - Discovery::Code Discovery::Enumerate PE Sections [B0046.001]\n    references:\n      - https://0x00sec.org/t/reflective-dll-injection/3080\n      - https://www.ired.team/offensive-security/code-injection-process-injection/reflective-dll-injection\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401510\n  features:\n    - and:\n      - os: windows\n      # there should be some complexity to functions like this\n      - count(basic blocks): 3 or more\n      - optional:\n        - offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n      - instruction:\n        - or:\n          - mnemonic: mov\n          - mnemonic: movzx\n        - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n      - basic block:\n        - or:\n          - and:\n            - description: IMAGE_FIRST_SECTION(nt_header)\n            - instruction:\n              - or:\n                - mnemonic: add\n                - mnemonic: mov\n                - mnemonic: movzx\n              - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n            - operand[1].offset: 0x18 = FileHeader.SizeOfOptionalHeader\n          - and:\n            - description: (DWORD)dll_raw + dos_header->e_lfanew + sizeof(IMAGE_NT_HEADERS) + sizeof(IMAGE_SECTION_HEADER) * i\n            - number: 0x28 = sizeof(IMAGE_SECTION_HEADER)\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0xF8 = sizeof(IMAGE_NT_HEADERS32)\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x108 = sizeof(IMAGE_NT_HEADERS64)\n      - 2 or more:\n        - operand[1].offset: 0xC = IMAGE_SECTION_HEADER.VirtualAddress\n        - operand[1].offset: 0x14 = IMAGE_SECTION_HEADER.PointerToRawData\n        - operand[1].offset: 0x10 = IMAGE_SECTION_HEADER.SizeOfRawData\n        # there's also offset 0x8 = IMAGE_SECTION_HEADER.Misc.PhysicalAddress, but it's likely too common\n      - not:\n        # non-zeroing XOR was observed in FPs\n        - characteristic: nzxor\n","matches":[[{"type":"absolute","value":4202985},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"instruction"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":6,"description":"IMAGE_NT_HEADERS.FileHeader.NumberOfSections"}},"children":[],"locations":[{"type":"absolute","value":4203104}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"mov"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"movzx"}},"children":[],"locations":[{"type":"absolute","value":4203104}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4203104}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and","description":"IMAGE_FIRST_SECTION(nt_header)"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"instruction"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":20,"description":"IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader"}},"children":[],"locations":[{"type":"absolute","value":4203100}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"add"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"mov"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"movzx"}},"children":[],"locations":[{"type":"absolute","value":4203100}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4203100}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":24,"description":"FileHeader.SizeOfOptionalHeader"}},"children":[],"locations":[{"type":"absolute","value":4203110}],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and","description":"(DWORD)dll_raw + dos_header->e_lfanew + sizeof(IMAGE_NT_HEADERS) + sizeof(IMAGE_SECTION_HEADER) * i"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":40,"description":"sizeof(IMAGE_SECTION_HEADER)"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":248,"description":"sizeof(IMAGE_NT_HEADERS32)"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":264,"description":"sizeof(IMAGE_NT_HEADERS64)"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4203100}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"range","min":3,"max":9223372036854775808,"child":{"type":"basic block"}}},"children":[],"locations":[{"type":"absolute","value":4203139},{"type":"absolute","value":4203525},{"type":"absolute","value":4203142},{"type":"absolute","value":4203018},{"type":"absolute","value":4203148},{"type":"absolute","value":4203404},{"type":"absolute","value":4203279},{"type":"absolute","value":4203536},{"type":"absolute","value":4203028},{"type":"absolute","value":4203033},{"type":"absolute","value":4203547},{"type":"absolute","value":4203167},{"type":"absolute","value":4203552},{"type":"absolute","value":4203044},{"type":"absolute","value":4203302},{"type":"absolute","value":4203563},{"type":"absolute","value":4203189},{"type":"absolute","value":4203318},{"type":"absolute","value":4203574},{"type":"absolute","value":4203325},{"type":"absolute","value":4203581},{"type":"absolute","value":4203071},{"type":"absolute","value":4203585},{"type":"absolute","value":4203590},{"type":"absolute","value":4203084},{"type":"absolute","value":4203597},{"type":"absolute","value":4203470},{"type":"absolute","value":4203600},{"type":"absolute","value":4203602},{"type":"absolute","value":4203092},{"type":"absolute","value":4203480},{"type":"absolute","value":4203100},{"type":"absolute","value":4203229},{"type":"absolute","value":4202985},{"type":"absolute","value":4203497},{"type":"absolute","value":4203116},{"type":"absolute","value":4203119},{"type":"absolute","value":4203503},{"type":"absolute","value":4203255},{"type":"absolute","value":4203128},{"type":"absolute","value":4203514},{"type":"absolute","value":4203132},{"type":"absolute","value":4203134}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"offset","offset":60,"description":"IMAGE_DOS_HEADER.e_lfanew"}},"children":[],"locations":[{"type":"absolute","value":4203444},{"type":"absolute","value":4203044},{"type":"absolute","value":4203071}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"some","count":2}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":12,"description":"IMAGE_SECTION_HEADER.VirtualAddress"}},"children":[],"locations":[{"type":"absolute","value":4203116}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":20,"description":"IMAGE_SECTION_HEADER.PointerToRawData"}},"children":[],"locations":[{"type":"absolute","value":4203100}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":16,"description":"IMAGE_SECTION_HEADER.SizeOfRawData"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4203632},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"instruction"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":6,"description":"IMAGE_NT_HEADERS.FileHeader.NumberOfSections"}},"children":[],"locations":[{"type":"absolute","value":4203826}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"mov"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"movzx"}},"children":[],"locations":[{"type":"absolute","value":4203826}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4203826}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and","description":"IMAGE_FIRST_SECTION(nt_header)"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"instruction"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":20,"description":"IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader"}},"children":[],"locations":[{"type":"absolute","value":4203654}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"add"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"mov"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"movzx"}},"children":[],"locations":[{"type":"absolute","value":4203654}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4203654}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":24,"description":"FileHeader.SizeOfOptionalHeader"}},"children":[],"locations":[{"type":"absolute","value":4203663}],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and","description":"(DWORD)dll_raw + dos_header->e_lfanew + sizeof(IMAGE_NT_HEADERS) + sizeof(IMAGE_SECTION_HEADER) * i"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":40,"description":"sizeof(IMAGE_SECTION_HEADER)"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":248,"description":"sizeof(IMAGE_NT_HEADERS32)"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":264,"description":"sizeof(IMAGE_NT_HEADERS64)"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4203632}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"range","min":3,"max":9223372036854775808,"child":{"type":"basic block"}}},"children":[],"locations":[{"type":"absolute","value":4203682},{"type":"absolute","value":4203842},{"type":"absolute","value":4203839},{"type":"absolute","value":4203847},{"type":"absolute","value":4203720},{"type":"absolute","value":4203818},{"type":"absolute","value":4203692},{"type":"absolute","value":4203632},{"type":"absolute","value":4203794},{"type":"absolute","value":4203763},{"type":"absolute","value":4203673},{"type":"absolute","value":4203676},{"type":"absolute","value":4203743}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":60,"description":"IMAGE_DOS_HEADER.e_lfanew"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"not"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"some","count":2}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":12,"description":"IMAGE_SECTION_HEADER.VirtualAddress"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":20,"description":"IMAGE_SECTION_HEADER.PointerToRawData"}},"children":[],"locations":[{"type":"absolute","value":4203654}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":16,"description":"IMAGE_SECTION_HEADER.SizeOfRawData"}},"children":[],"locations":[{"type":"absolute","value":4203673}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"parse PE header":{"meta":{"name":"parse PE header","namespace":"load-code/pe","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function"},"attack":[{"parts":["Execution","Shared Modules"],"tactic":"Execution","technique":"Shared Modules","subtechnique":"","id":"T1129"}],"mbc":[],"references":[],"examples":["9324D1A8AE37A36AE560C37448C9705A:0x403DD0"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: parse PE header\n    namespace: load-code/pe\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic, operand[1].offset features\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403DD0\n  features:\n    - and:\n      - os: windows\n      - and:\n        - mnemonic: cmp\n        - or:\n          - number: 0x4550 = IMAGE_NT_SIGNATURE (PE)\n          - and:\n            - number: 0x50\n            - number: 0x45\n        - or:\n          - number: 0x5A4D = IMAGE_DOS_SIGNATURE (MZ)\n          - and:\n            - number: 0x4D\n            - number: 0x5A\n        - optional:\n          - and:\n            - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n            - or:\n              - and:\n                - arch: i386\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n              - and:\n                - arch: amd64\n                - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n                - operand[1].offset: 0x30 = IMAGE_NT_HEADERS64.OptionalHeader.ImageBase\n          - basic block:\n            - and:\n              - operand[1].offset: 0x3C = IMAGE_DOS_HEADER.e_lfanew\n              - 3 or more:\n                - operand[1].offset: 0x4 = IMAGE_NT_HEADERS.FileHeader.Machine\n                - operand[1].offset: 0x6 = IMAGE_NT_HEADERS.FileHeader.NumberOfSections\n                - operand[1].offset: 0x14 = IMAGE_NT_HEADERS.FileHeader.SizeOfOptionalHeader\n                - operand[1].offset: 0x16 = IMAGE_NT_HEADERS.FileHeader.Characteristics\n                - operand[1].offset: 0x28 = IMAGE_NT_HEADERS.OptionalHeader.AddressOfEntryPoint  # for 32 and 64 bit\n                - or:\n                  - and:\n                    - arch: i386\n                    - operand[1].offset: 0x34 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage\n                  - and:\n                    - arch: amd64\n                    - operand[1].offset: 0x30 = IMAGE_NT_HEADERS.OptionalHeader.ImageBase\n                    - operand[1].offset: 0x50 = IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage\n","matches":[[{"type":"absolute","value":4202985},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"cmp"}},"children":[],"locations":[{"type":"absolute","value":4203076},{"type":"absolute","value":4203221},{"type":"absolute","value":4203543},{"type":"absolute","value":4203547},{"type":"absolute","value":4203084},{"type":"absolute","value":4203021},{"type":"absolute","value":4203134}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":17744,"description":"IMAGE_NT_SIGNATURE (PE)"}},"children":[],"locations":[{"type":"absolute","value":4203076}],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":80}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":69}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":23117,"description":"IMAGE_DOS_SIGNATURE (MZ)"}},"children":[],"locations":[{"type":"absolute","value":4203021}],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":77}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":90}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":60,"description":"IMAGE_DOS_HEADER.e_lfanew"}},"children":[],"locations":[{"type":"absolute","value":4203444},{"type":"absolute","value":4203044},{"type":"absolute","value":4203071}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":80,"description":"IMAGE_NT_HEADERS.OptionalHeader.SizeOfImage"}},"children":[],"locations":[{"type":"absolute","value":4203198}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":52,"description":"IMAGE_NT_HEADERS.OptionalHeader.ImageBase"}},"children":[],"locations":[{"type":"absolute","value":4203472},{"type":"absolute","value":4203475}],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":80,"description":"IMAGE_NT_HEADERS64.OptionalHeader.SizeOfImage"}},"children":[],"locations":[{"type":"absolute","value":4203198}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"operand offset","index":1,"operand_offset":48,"description":"IMAGE_NT_HEADERS64.OptionalHeader.ImageBase"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"parse PE header/3d72a7963aed4717a2f194bf68deac27"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"encrypt data using RC4 KSA":{"meta":{"name":"encrypt data using RC4 KSA","namespace":"data-manipulation/encryption/rc4","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function"},"attack":[{"parts":["Defense Evasion","Obfuscated Files or Information"],"tactic":"Defense Evasion","technique":"Obfuscated Files or Information","subtechnique":"","id":"T1027"}],"mbc":[{"parts":["Cryptography","Encrypt Data","RC4"],"objective":"Cryptography","behavior":"Encrypt Data","method":"RC4","id":"C0027.009"},{"parts":["Cryptography","Encryption Key","RC4 KSA"],"objective":"Cryptography","behavior":"Encryption Key","method":"RC4 KSA","id":"C0028.002"}],"references":[],"examples":["34404A3FB9804977C6AB86CB991FB130:0x403D40","9324D1A8AE37A36AE560C37448C9705A:0x404950","2B8BEC5BCB1777EAA155D832F7AFC797:0x405C42","73CE04892E5F39EC82B00C02FC04C70F:0x40646E"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: encrypt data using RC4 KSA\n    namespace: data-manipulation/encryption/rc4\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, mnemonic, Not features\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Cryptography::Encrypt Data::RC4 [C0027.009]\n      - Cryptography::Encryption Key::RC4 KSA [C0028.002]\n    examples:\n      - 34404A3FB9804977C6AB86CB991FB130:0x403D40\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404950\n      - 2B8BEC5BCB1777EAA155D832F7AFC797:0x405C42\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x40646E\n  features:\n    - or:\n      - and:\n        - basic block:\n          - and:\n            - description: initialize S\n            # misses if regular loop is used,\n            # however we cannot model that a loop contains a certain number\n            - characteristic: tight loop\n            - or:\n              - number: 0xFF\n              - number: 0x100\n        - or:\n          - description: modulo 256\n          - match: calculate modulo 256 via x86 assembly\n          - basic block:\n            - and:\n              - description: modulo via zero-extended mov from 8-bit register\n              - count(mnemonic(movzx)): 2 or more\n              # avoid false positives; filter out unexpected instructions\n              - not:\n                - or:\n                  - mnemonic: shl\n                  - mnemonic: rol\n                  - characteristic: nzxor\n        - or:\n          - description: modulo key length\n          - mnemonic: div\n          - mnemonic: idiv\n      - and:\n        - description: write DWORDs instead of bytes\n        - or:\n          - number: 0x03020100\n          - number: 0xFFFEFDFC\n        - instruction:\n          - or:\n            - mnemonic: add\n            - mnemonic: sub\n          - number: 0x04040404\n","matches":[[{"type":"absolute","value":4205174},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and","description":"write DWORDs instead of bytes"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":50462976}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294901244}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"encrypt data using RC4 KSA/2abd1135e10f4a52925d74840451a024"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and","description":"initialize S"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4206117}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4206150}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":256}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4206117}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or","description":"modulo 256"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"calculate modulo 256 via x86 assembly"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4205938}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4205938}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4206150}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4206150}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4205783}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4205783}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4205938},{"type":"absolute","value":4206150},{"type":"absolute","value":4205783}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"encrypt data using RC4 KSA/f6f6874757de40908654f01096240656"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or","description":"modulo key length"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"div"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"idiv"}},"children":[],"locations":[{"type":"absolute","value":4206016},{"type":"absolute","value":4205476},{"type":"absolute","value":4205685},{"type":"absolute","value":4205576},{"type":"absolute","value":4206025},{"type":"absolute","value":4205675}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207887},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and","description":"write DWORDs instead of bytes"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":50462976}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294901244}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"encrypt data using RC4 KSA/2abd1135e10f4a52925d74840451a024"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and","description":"initialize S"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4208370}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4208498}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":256}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and","description":"initialize S"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4208159}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4208202}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":256}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4208370},{"type":"absolute","value":4208159}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or","description":"modulo 256"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"calculate modulo 256 via x86 assembly"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4208202}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4208202}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4208498}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4208498}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4208202},{"type":"absolute","value":4208498}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"encrypt data using RC4 KSA/f6f6874757de40908654f01096240656"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or","description":"modulo key length"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"div"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"idiv"}},"children":[],"locations":[{"type":"absolute","value":4208225},{"type":"absolute","value":4208424},{"type":"absolute","value":4208454},{"type":"absolute","value":4208168},{"type":"absolute","value":4208489},{"type":"absolute","value":4207965},{"type":"absolute","value":4208190}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208535},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and","description":"write DWORDs instead of bytes"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":50462976}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294901244}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"encrypt data using RC4 KSA/2abd1135e10f4a52925d74840451a024"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and","description":"initialize S"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4209024}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4209155}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":256}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and","description":"initialize S"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4208813}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4208856}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":256}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4209024},{"type":"absolute","value":4208813}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or","description":"modulo 256"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"calculate modulo 256 via x86 assembly"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4208856}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4208856}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4209155}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4209155}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4208856},{"type":"absolute","value":4209155}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"encrypt data using RC4 KSA/f6f6874757de40908654f01096240656"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or","description":"modulo key length"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"div"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"idiv"}},"children":[],"locations":[{"type":"absolute","value":4208613},{"type":"absolute","value":4208822},{"type":"absolute","value":4209111},{"type":"absolute","value":4209081},{"type":"absolute","value":4209146},{"type":"absolute","value":4208844},{"type":"absolute","value":4208879}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"encrypt data using AES":{"meta":{"name":"encrypt data using AES","namespace":"data-manipulation/encryption/aes","authors":["william.ballenthin@mandiant.com","Ivan Kwiatkowski (@JusticeRage)"],"scopes":{"static":"function"},"attack":[{"parts":["Defense Evasion","Obfuscated Files or Information"],"tactic":"Defense Evasion","technique":"Obfuscated Files or Information","subtechnique":"","id":"T1027"}],"mbc":[{"parts":["Defense Evasion","Obfuscated Files or Information","Encryption-Standard Algorithm"],"objective":"Defense Evasion","behavior":"Obfuscated Files or Information","method":"Encryption-Standard Algorithm","id":"E1027.m05"},{"parts":["Cryptography","Encrypt Data","AES"],"objective":"Cryptography","behavior":"Encrypt Data","method":"AES","id":"C0027.001"}],"references":["https://github.com/JusticeRage/Manalyze/blob/8e77642c911d5d82b5f43b198667ab8c77a88763/bin/yara_rules/findcrypt.yara#L351","https://github.com/creaktive/tsh/blob/53b822b9a07d8cc65f1f31c915cf834a2944e833/aes.c"],"examples":[],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"# generated using capa explorer for IDA Pro\nrule:\n  meta:\n    name: encrypt data using AES\n    namespace: data-manipulation/encryption/aes\n    authors:\n      - william.ballenthin@mandiant.com\n      - Ivan Kwiatkowski (@JusticeRage)\n    scopes:\n      static: function\n      dynamic: unsupported  # requires bytes features\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Defense Evasion::Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]\n      - Cryptography::Encrypt Data::AES [C0027.001]\n    references:\n      - https://github.com/JusticeRage/Manalyze/blob/8e77642c911d5d82b5f43b198667ab8c77a88763/bin/yara_rules/findcrypt.yara#L351\n      - https://github.com/creaktive/tsh/blob/53b822b9a07d8cc65f1f31c915cf834a2944e833/aes.c\n  features:\n    - or:\n      - bytes: 63 7c 77 7b f2 6b 6f c5 30 01 67 2b fe d7 ab 76 = AES_SBOX_ENC\n      - bytes: 63 00 00 00 00 00 00 00 7c 00 00 00 00 00 00 00 77 00 00 00 00 00 00 00 7b 00 00 00 00 00 00 00 f2 00 00 00 00 00 00 00 6b 00 00 00 00 00 00 00 6f 00 00 00 00 00 00 00 c5 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 67 00 00 00 00 00 00 00 2b 00 00 00 00 00 00 00 fe 00 00 00 00 00 00 00 d7 00 00 00 00 00 00 00 ab 00 00 00 00 00 00 00 76 = AES_SBOX_ENC\n      - bytes: 52 09 6a d5 30 36 a5 38 bf 40 a3 9e 81 f3 d7 fb = AES_SBOX_DEC\n      - bytes: 52 00 00 00 00 00 00 00 09 00 00 00 00 00 00 00 6a 00 00 00 00 00 00 00 d5 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 36 00 00 00 00 00 00 00 a5 00 00 00 00 00 00 00 38 00 00 00 00 00 00 00 bf 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 a3 00 00 00 00 00 00 00 9e 00 00 00 00 00 00 00 81 00 00 00 00 00 00 00 f3 00 00 00 00 00 00 00 d7 00 00 00 00 00 00 00 fb = AES_SBOX_DEC\n      - bytes: a5 63 63 c6 84 7c 7c f8 99 77 77 ee 8d 7b 7b f6 = AES_T0_ENC\n      - bytes: a5 63 63 c6 00 00 00 00 84 7c 7c f8 00 00 00 00 99 77 77 ee 00 00 00 00 8d 7b 7b f6 = AES_T0_ENC\n      - bytes: 63 63 c6 a5 7c 7c f8 84 77 77 ee 99 7b 7b f6 8d = AES_T1_ENC\n      - bytes: 63 63 c6 a5 00 00 00 00 7c 7c f8 84 00 00 00 00 77 77 ee 99 00 00 00 00 7b 7b f6 8d = AES_T1_ENC\n      - bytes: 63 c6 a5 63 7c f8 84 7c 77 ee 99 77 7b f6 8d 7b = AES_T2_ENC\n      - bytes: 63 c6 a5 63 00 00 00 00 7c f8 84 7c 00 00 00 00 77 ee 99 77 00 00 00 00 7b f6 8d 7b = AES_T2_ENC\n      - bytes: c6 a5 63 63 f8 84 7c 7c ee 99 77 77 f6 8d 7b 7b = AES_T3_ENC\n      - bytes: c6 a5 63 63 00 00 00 00 f8 84 7c 7c 00 00 00 00 ee 99 77 77 00 00 00 00 f6 8d 7b 7b = AES_T3_ENC\n      - bytes: 63 63 63 63 7c 7c 7c 7c 77 77 77 77 7b 7b 7b 7b = AES_T4_ENC\n      - bytes: 50 a7 f4 51 53 65 41 7e c3 a4 17 1a 96 5e 27 3a = AES_T0_DEC\n      - bytes: 50 a7 f4 51 00 00 00 00 53 65 41 7e 00 00 00 00 c3 a4 17 1a 00 00 00 00 96 5e 27 3a = AES_T0_DEC\n      - bytes: a7 f4 51 50 65 41 7e 53 a4 17 1a c3 5e 27 3a 96 = AES_T1_DEC\n      - bytes: a7 f4 51 50 00 00 00 00 65 41 7e 53 00 00 00 00 a4 17 1a c3 00 00 00 00 5e 27 3a 96 = AES_T1_DEC\n      - bytes: f4 51 50 a7 41 7e 53 65 17 1a c3 a4 27 3a 96 5e = AES_T2_DEC\n      - bytes: f4 51 50 a7 00 00 00 00 41 7e 53 65 00 00 00 00 17 1a c3 a4 00 00 00 00 27 3a 96 5e = AES_T2_DEC\n      - bytes: 51 50 a7 f4 7e 53 65 41 1a c3 a4 17 3a 96 5e 27 = AES_T3_DEC\n      - bytes: 51 50 a7 f4 00 00 00 00 7e 53 65 41 00 00 00 00 1a c3 a4 17 00 00 00 00 3a 96 5e 27 = AES_T3_DEC\n      - bytes: 52 52 52 52 09 09 09 09 6a 6a 6a 6a d5 d5 d5 d5 = AES_T4_DEC\n","matches":[[{"type":"absolute","value":4205174},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"637c777bf26b6fc53001672bfed7ab76","description":"AES_SBOX_ENC"}},"children":[],"locations":[{"type":"absolute","value":4205953},{"type":"absolute","value":4205922},{"type":"absolute","value":4205798},{"type":"absolute","value":4205770},{"type":"absolute","value":4205946},{"type":"absolute","value":4205915},{"type":"absolute","value":4205820},{"type":"absolute","value":4205791}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63000000000000007c0000000000000077000000000000007b00000000000000f2000000000000006b000000000000006f00000000000000c5000000000000003000000000000000010000000000000067000000000000002b00000000000000fe00000000000000d700000000000000ab0000000000000076","description":"AES_SBOX_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52096ad53036a538bf40a39e81f3d7fb","description":"AES_SBOX_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"520000000000000009000000000000006a00000000000000d50000000000000030000000000000003600000000000000a5000000000000003800000000000000bf000000000000004000000000000000a3000000000000009e000000000000008100000000000000f300000000000000d700000000000000fb","description":"AES_SBOX_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a56363c6847c7cf8997777ee8d7b7bf6","description":"AES_T0_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a56363c600000000847c7cf800000000997777ee000000008d7b7bf6","description":"AES_T0_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"6363c6a57c7cf8847777ee997b7bf68d","description":"AES_T1_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"6363c6a5000000007c7cf884000000007777ee99000000007b7bf68d","description":"AES_T1_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63c6a5637cf8847c77ee99777bf68d7b","description":"AES_T2_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63c6a563000000007cf8847c0000000077ee9977000000007bf68d7b","description":"AES_T2_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"c6a56363f8847c7cee997777f68d7b7b","description":"AES_T3_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"c6a5636300000000f8847c7c00000000ee99777700000000f68d7b7b","description":"AES_T3_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"636363637c7c7c7c777777777b7b7b7b","description":"AES_T4_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f4515365417ec3a4171a965e273a","description":"AES_T0_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f451000000005365417e00000000c3a4171a00000000965e273a","description":"AES_T0_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a7f4515065417e53a4171ac35e273a96","description":"AES_T1_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a7f451500000000065417e5300000000a4171ac3000000005e273a96","description":"AES_T1_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"f45150a7417e5365171ac3a4273a965e","description":"AES_T2_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"f45150a700000000417e536500000000171ac3a400000000273a965e","description":"AES_T2_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"5150a7f47e5365411ac3a4173a965e27","description":"AES_T3_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"5150a7f4000000007e536541000000001ac3a417000000003a965e27","description":"AES_T3_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52525252090909096a6a6a6ad5d5d5d5","description":"AES_T4_DEC"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4206206},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"637c777bf26b6fc53001672bfed7ab76","description":"AES_SBOX_ENC"}},"children":[],"locations":[{"type":"absolute","value":4206725},{"type":"absolute","value":4206853},{"type":"absolute","value":4206918},{"type":"absolute","value":4206986},{"type":"absolute","value":4206868},{"type":"absolute","value":4206807},{"type":"absolute","value":4206937},{"type":"absolute","value":4206746},{"type":"absolute","value":4207007},{"type":"absolute","value":4207019},{"type":"absolute","value":4206893},{"type":"absolute","value":4206702},{"type":"absolute","value":4206767},{"type":"absolute","value":4206832},{"type":"absolute","value":4206965},{"type":"absolute","value":4206782}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63000000000000007c0000000000000077000000000000007b00000000000000f2000000000000006b000000000000006f00000000000000c5000000000000003000000000000000010000000000000067000000000000002b00000000000000fe00000000000000d700000000000000ab0000000000000076","description":"AES_SBOX_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52096ad53036a538bf40a39e81f3d7fb","description":"AES_SBOX_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"520000000000000009000000000000006a00000000000000d50000000000000030000000000000003600000000000000a5000000000000003800000000000000bf000000000000004000000000000000a3000000000000009e000000000000008100000000000000f300000000000000d700000000000000fb","description":"AES_SBOX_DEC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a56363c6847c7cf8997777ee8d7b7bf6","description":"AES_T0_ENC"}},"children":[],"locations":[{"type":"absolute","value":4206558},{"type":"absolute","value":4206629},{"type":"absolute","value":4206501},{"type":"absolute","value":4206462}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a56363c600000000847c7cf800000000997777ee000000008d7b7bf6","description":"AES_T0_ENC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"6363c6a57c7cf8847777ee997b7bf68d","description":"AES_T1_ENC"}},"children":[],"locations":[{"type":"absolute","value":4206577},{"type":"absolute","value":4206450},{"type":"absolute","value":4206617},{"type":"absolute","value":4206494}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"6363c6a5000000007c7cf884000000007777ee99000000007b7bf68d","description":"AES_T1_ENC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63c6a5637cf8847c77ee99777bf68d7b","description":"AES_T2_ENC"}},"children":[],"locations":[{"type":"absolute","value":4206441},{"type":"absolute","value":4206517},{"type":"absolute","value":4206565},{"type":"absolute","value":4206607}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63c6a563000000007cf8847c0000000077ee9977000000007bf68d7b","description":"AES_T2_ENC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"c6a56363f8847c7cee997777f68d7b7b","description":"AES_T3_ENC"}},"children":[],"locations":[{"type":"absolute","value":4206588},{"type":"absolute","value":4206530},{"type":"absolute","value":4206476},{"type":"absolute","value":4206644}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"c6a5636300000000f8847c7c00000000ee99777700000000f68d7b7b","description":"AES_T3_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"636363637c7c7c7c777777777b7b7b7b","description":"AES_T4_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f4515365417ec3a4171a965e273a","description":"AES_T0_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f451000000005365417e00000000c3a4171a00000000965e273a","description":"AES_T0_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a7f4515065417e53a4171ac35e273a96","description":"AES_T1_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a7f451500000000065417e5300000000a4171ac3000000005e273a96","description":"AES_T1_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"f45150a7417e5365171ac3a4273a965e","description":"AES_T2_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"f45150a700000000417e536500000000171ac3a400000000273a965e","description":"AES_T2_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"5150a7f47e5365411ac3a4173a965e27","description":"AES_T3_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"5150a7f4000000007e536541000000001ac3a417000000003a965e27","description":"AES_T3_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52525252090909096a6a6a6ad5d5d5d5","description":"AES_T4_DEC"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207036},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"637c777bf26b6fc53001672bfed7ab76","description":"AES_SBOX_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63000000000000007c0000000000000077000000000000007b00000000000000f2000000000000006b000000000000006f00000000000000c5000000000000003000000000000000010000000000000067000000000000002b00000000000000fe00000000000000d700000000000000ab0000000000000076","description":"AES_SBOX_ENC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52096ad53036a538bf40a39e81f3d7fb","description":"AES_SBOX_DEC"}},"children":[],"locations":[{"type":"absolute","value":4207553},{"type":"absolute","value":4207745},{"type":"absolute","value":4207619},{"type":"absolute","value":4207684},{"type":"absolute","value":4207816},{"type":"absolute","value":4207634},{"type":"absolute","value":4207576},{"type":"absolute","value":4207769},{"type":"absolute","value":4207705},{"type":"absolute","value":4207837},{"type":"absolute","value":4207720},{"type":"absolute","value":4207659},{"type":"absolute","value":4207595},{"type":"absolute","value":4207788},{"type":"absolute","value":4207858},{"type":"absolute","value":4207870}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"520000000000000009000000000000006a00000000000000d50000000000000030000000000000003600000000000000a5000000000000003800000000000000bf000000000000004000000000000000a3000000000000009e000000000000008100000000000000f300000000000000d700000000000000fb","description":"AES_SBOX_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a56363c6847c7cf8997777ee8d7b7bf6","description":"AES_T0_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a56363c600000000847c7cf800000000997777ee000000008d7b7bf6","description":"AES_T0_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"6363c6a57c7cf8847777ee997b7bf68d","description":"AES_T1_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"6363c6a5000000007c7cf884000000007777ee99000000007b7bf68d","description":"AES_T1_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63c6a5637cf8847c77ee99777bf68d7b","description":"AES_T2_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63c6a563000000007cf8847c0000000077ee9977000000007bf68d7b","description":"AES_T2_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"c6a56363f8847c7cee997777f68d7b7b","description":"AES_T3_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"c6a5636300000000f8847c7c00000000ee99777700000000f68d7b7b","description":"AES_T3_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"636363637c7c7c7c777777777b7b7b7b","description":"AES_T4_ENC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f4515365417ec3a4171a965e273a","description":"AES_T0_DEC"}},"children":[],"locations":[{"type":"absolute","value":4207471},{"type":"absolute","value":4207337},{"type":"absolute","value":4207388},{"type":"absolute","value":4207295}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f451000000005365417e00000000c3a4171a00000000965e273a","description":"AES_T0_DEC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a7f4515065417e53a4171ac35e273a96","description":"AES_T1_DEC"}},"children":[],"locations":[{"type":"absolute","value":4207344},{"type":"absolute","value":4207395},{"type":"absolute","value":4207443},{"type":"absolute","value":4207307}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a7f451500000000065417e5300000000a4171ac3000000005e273a96","description":"AES_T1_DEC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"f45150a7417e5365171ac3a4273a965e","description":"AES_T2_DEC"}},"children":[],"locations":[{"type":"absolute","value":4207456},{"type":"absolute","value":4207410},{"type":"absolute","value":4207357},{"type":"absolute","value":4207286}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"f45150a700000000417e536500000000171ac3a400000000273a965e","description":"AES_T2_DEC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"5150a7f47e5365411ac3a4173a965e27","description":"AES_T3_DEC"}},"children":[],"locations":[{"type":"absolute","value":4207369},{"type":"absolute","value":4207322},{"type":"absolute","value":4207486},{"type":"absolute","value":4207417}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"5150a7f4000000007e536541000000001ac3a417000000003a965e27","description":"AES_T3_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52525252090909096a6a6a6ad5d5d5d5","description":"AES_T4_DEC"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207887},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"637c777bf26b6fc53001672bfed7ab76","description":"AES_SBOX_ENC"}},"children":[],"locations":[{"type":"absolute","value":4208472},{"type":"absolute","value":4208441},{"type":"absolute","value":4208503},{"type":"absolute","value":4208407}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63000000000000007c0000000000000077000000000000007b00000000000000f2000000000000006b000000000000006f00000000000000c5000000000000003000000000000000010000000000000067000000000000002b00000000000000fe00000000000000d700000000000000ab0000000000000076","description":"AES_SBOX_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52096ad53036a538bf40a39e81f3d7fb","description":"AES_SBOX_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"520000000000000009000000000000006a00000000000000d50000000000000030000000000000003600000000000000a5000000000000003800000000000000bf000000000000004000000000000000a3000000000000009e000000000000008100000000000000f300000000000000d700000000000000fb","description":"AES_SBOX_DEC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a56363c6847c7cf8997777ee8d7b7bf6","description":"AES_T0_ENC"}},"children":[],"locations":[{"type":"absolute","value":4208248}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a56363c600000000847c7cf800000000997777ee000000008d7b7bf6","description":"AES_T0_ENC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"6363c6a57c7cf8847777ee997b7bf68d","description":"AES_T1_ENC"}},"children":[],"locations":[{"type":"absolute","value":4208236}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"6363c6a5000000007c7cf884000000007777ee99000000007b7bf68d","description":"AES_T1_ENC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63c6a5637cf8847c77ee99777bf68d7b","description":"AES_T2_ENC"}},"children":[],"locations":[{"type":"absolute","value":4208207}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63c6a563000000007cf8847c0000000077ee9977000000007bf68d7b","description":"AES_T2_ENC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"c6a56363f8847c7cee997777f68d7b7b","description":"AES_T3_ENC"}},"children":[],"locations":[{"type":"absolute","value":4208214}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"c6a5636300000000f8847c7c00000000ee99777700000000f68d7b7b","description":"AES_T3_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"636363637c7c7c7c777777777b7b7b7b","description":"AES_T4_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f4515365417ec3a4171a965e273a","description":"AES_T0_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f451000000005365417e00000000c3a4171a00000000965e273a","description":"AES_T0_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a7f4515065417e53a4171ac35e273a96","description":"AES_T1_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a7f451500000000065417e5300000000a4171ac3000000005e273a96","description":"AES_T1_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"f45150a7417e5365171ac3a4273a965e","description":"AES_T2_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"f45150a700000000417e536500000000171ac3a400000000273a965e","description":"AES_T2_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"5150a7f47e5365411ac3a4173a965e27","description":"AES_T3_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"5150a7f4000000007e536541000000001ac3a417000000003a965e27","description":"AES_T3_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52525252090909096a6a6a6ad5d5d5d5","description":"AES_T4_DEC"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208535},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"637c777bf26b6fc53001672bfed7ab76","description":"AES_SBOX_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63000000000000007c0000000000000077000000000000007b00000000000000f2000000000000006b000000000000006f00000000000000c5000000000000003000000000000000010000000000000067000000000000002b00000000000000fe00000000000000d700000000000000ab0000000000000076","description":"AES_SBOX_ENC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52096ad53036a538bf40a39e81f3d7fb","description":"AES_SBOX_DEC"}},"children":[],"locations":[{"type":"absolute","value":4209064},{"type":"absolute","value":4209129},{"type":"absolute","value":4209098},{"type":"absolute","value":4209160}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"520000000000000009000000000000006a00000000000000d50000000000000030000000000000003600000000000000a5000000000000003800000000000000bf000000000000004000000000000000a3000000000000009e000000000000008100000000000000f300000000000000d700000000000000fb","description":"AES_SBOX_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a56363c6847c7cf8997777ee8d7b7bf6","description":"AES_T0_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a56363c600000000847c7cf800000000997777ee000000008d7b7bf6","description":"AES_T0_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"6363c6a57c7cf8847777ee997b7bf68d","description":"AES_T1_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"6363c6a5000000007c7cf884000000007777ee99000000007b7bf68d","description":"AES_T1_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63c6a5637cf8847c77ee99777bf68d7b","description":"AES_T2_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"63c6a563000000007cf8847c0000000077ee9977000000007bf68d7b","description":"AES_T2_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"c6a56363f8847c7cee997777f68d7b7b","description":"AES_T3_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"c6a5636300000000f8847c7c00000000ee99777700000000f68d7b7b","description":"AES_T3_ENC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"636363637c7c7c7c777777777b7b7b7b","description":"AES_T4_ENC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f4515365417ec3a4171a965e273a","description":"AES_T0_DEC"}},"children":[],"locations":[{"type":"absolute","value":4208902}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f451000000005365417e00000000c3a4171a00000000965e273a","description":"AES_T0_DEC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a7f4515065417e53a4171ac35e273a96","description":"AES_T1_DEC"}},"children":[],"locations":[{"type":"absolute","value":4208890}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"a7f451500000000065417e5300000000a4171ac3000000005e273a96","description":"AES_T1_DEC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"f45150a7417e5365171ac3a4273a965e","description":"AES_T2_DEC"}},"children":[],"locations":[{"type":"absolute","value":4208861}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"f45150a700000000417e536500000000171ac3a400000000273a965e","description":"AES_T2_DEC"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"5150a7f47e5365411ac3a4173a965e27","description":"AES_T3_DEC"}},"children":[],"locations":[{"type":"absolute","value":4208868}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"5150a7f4000000007e536541000000001ac3a417000000003a965e27","description":"AES_T3_DEC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52525252090909096a6a6a6ad5d5d5d5","description":"AES_T4_DEC"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"reference AES constants":{"meta":{"name":"reference AES constants","namespace":"data-manipulation/encryption/aes","authors":["william.ballenthin@mandiant.com"],"scopes":{"static":"function"},"attack":[{"parts":["Defense Evasion","Obfuscated Files or Information"],"tactic":"Defense Evasion","technique":"Obfuscated Files or Information","subtechnique":"","id":"T1027"}],"mbc":[],"references":[],"examples":[],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: reference AES constants\n    namespace: data-manipulation/encryption/aes\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires bytes features\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n  features:\n    - or:\n      - bytes: 50 a7 f4 51 53 65 41 7e = d-0\n      - bytes: 63 7c 77 7b f2 6b 6f c5 = s-box\n      - bytes: 52 09 6a d5 30 36 a5 38 = inv-s-box\n","matches":[[{"type":"absolute","value":4205174},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f4515365417e","description":"d-0"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"637c777bf26b6fc5","description":"s-box"}},"children":[],"locations":[{"type":"absolute","value":4205953},{"type":"absolute","value":4205922},{"type":"absolute","value":4205798},{"type":"absolute","value":4205770},{"type":"absolute","value":4205946},{"type":"absolute","value":4205915},{"type":"absolute","value":4205820},{"type":"absolute","value":4205791}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52096ad53036a538","description":"inv-s-box"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4206206},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f4515365417e","description":"d-0"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"637c777bf26b6fc5","description":"s-box"}},"children":[],"locations":[{"type":"absolute","value":4206725},{"type":"absolute","value":4206853},{"type":"absolute","value":4206918},{"type":"absolute","value":4206986},{"type":"absolute","value":4206868},{"type":"absolute","value":4206807},{"type":"absolute","value":4206937},{"type":"absolute","value":4206746},{"type":"absolute","value":4207007},{"type":"absolute","value":4207019},{"type":"absolute","value":4206893},{"type":"absolute","value":4206702},{"type":"absolute","value":4206767},{"type":"absolute","value":4206832},{"type":"absolute","value":4206965},{"type":"absolute","value":4206782}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52096ad53036a538","description":"inv-s-box"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207036},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f4515365417e","description":"d-0"}},"children":[],"locations":[{"type":"absolute","value":4207471},{"type":"absolute","value":4207337},{"type":"absolute","value":4207388},{"type":"absolute","value":4207295}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"637c777bf26b6fc5","description":"s-box"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52096ad53036a538","description":"inv-s-box"}},"children":[],"locations":[{"type":"absolute","value":4207553},{"type":"absolute","value":4207745},{"type":"absolute","value":4207619},{"type":"absolute","value":4207684},{"type":"absolute","value":4207816},{"type":"absolute","value":4207634},{"type":"absolute","value":4207576},{"type":"absolute","value":4207769},{"type":"absolute","value":4207705},{"type":"absolute","value":4207837},{"type":"absolute","value":4207720},{"type":"absolute","value":4207659},{"type":"absolute","value":4207595},{"type":"absolute","value":4207788},{"type":"absolute","value":4207858},{"type":"absolute","value":4207870}],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207887},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f4515365417e","description":"d-0"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"637c777bf26b6fc5","description":"s-box"}},"children":[],"locations":[{"type":"absolute","value":4208472},{"type":"absolute","value":4208441},{"type":"absolute","value":4208503},{"type":"absolute","value":4208407}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52096ad53036a538","description":"inv-s-box"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208535},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"50a7f4515365417e","description":"d-0"}},"children":[],"locations":[{"type":"absolute","value":4208902}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"bytes","bytes":"637c777bf26b6fc5","description":"s-box"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"52096ad53036a538","description":"inv-s-box"}},"children":[],"locations":[{"type":"absolute","value":4209064},{"type":"absolute","value":4209129},{"type":"absolute","value":4209098},{"type":"absolute","value":4209160}],"captures":{}}],"locations":[],"captures":{}}]]},"hash data with CRC32":{"meta":{"name":"hash data with CRC32","namespace":"data-manipulation/checksum/crc32","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function"},"attack":[],"mbc":[{"parts":["Data","Checksum","CRC32"],"objective":"Data","behavior":"Checksum","method":"CRC32","id":"C0032.001"}],"references":[],"examples":["2D3EDC218A90F03089CC01715A9F047F:0x403CBD","7D28CB106CB54876B2A5C111724A07CD:0x402350","7EFF498DE13CC734262F87E6B3EF38AB:0x100084A6"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: hash data with CRC32\n    namespace: data-manipulation/checksum/crc32\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires operand[1].number, characteristic, bytes, mnemonic features\n    mbc:\n      - Data::Checksum::CRC32 [C0032.001]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x403CBD\n      - 7D28CB106CB54876B2A5C111724A07CD:0x402350  # RtlComputeCrc32\n      - 7EFF498DE13CC734262F87E6B3EF38AB:0x100084A6\n  features:\n    - or:\n      - and:\n        - number: 1 = bits in a byte\n        - instruction:\n          - description: is bit set?\n          - or:\n            - mnemonic: and\n            - mnemonic: test\n          - operand[1].number: 1\n        - instruction:\n          - mnemonic: shr\n          - number: 1\n        - characteristic: nzxor\n        - operand[1].number: 0xEDB88320\n      - and:\n        - number: 0x8320\n        - number: 0xEDB8\n        - characteristic: nzxor\n      - api: RtlComputeCrc32\n      - bytes: 00 00 00 00 96 30 07 77 2C 61 0E EE BA 51 09 99 19 C4 6D 07 8F F4 6A 70 35 A5 63 E9 A3 95 64 9E = crc32_tab\n","matches":[[{"type":"absolute","value":4215839},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlComputeCrc32"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"00000000963007772c610eeeba51099919c46d078ff46a7035a563e9a395649e","description":"crc32_tab"}},"children":[],"locations":[{"type":"absolute","value":4216096},{"type":"absolute","value":4215969},{"type":"absolute","value":4216038},{"type":"absolute","value":4215946},{"type":"absolute","value":4215900},{"type":"absolute","value":4216015},{"type":"absolute","value":4215923},{"type":"absolute","value":4215992},{"type":"absolute","value":4216060}],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":33568}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":60856}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4216002},{"type":"absolute","value":4216067},{"type":"absolute","value":4215940},{"type":"absolute","value":4216009},{"type":"absolute","value":4215956},{"type":"absolute","value":4215893},{"type":"absolute","value":4216025},{"type":"absolute","value":4215963},{"type":"absolute","value":4216091},{"type":"absolute","value":4216032},{"type":"absolute","value":4215907},{"type":"absolute","value":4216103},{"type":"absolute","value":4215979},{"type":"absolute","value":4215917},{"type":"absolute","value":4216048},{"type":"absolute","value":4215986},{"type":"absolute","value":4216055},{"type":"absolute","value":4215933}],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1,"description":"bits in a byte"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"hash data with CRC32/0ea7593c486f4685832f314576a71e20"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"hash data with CRC32/fc547c56da93402588a2dd3cd80f6156"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4216002},{"type":"absolute","value":4216067},{"type":"absolute","value":4215940},{"type":"absolute","value":4216009},{"type":"absolute","value":4215956},{"type":"absolute","value":4215893},{"type":"absolute","value":4216025},{"type":"absolute","value":4215963},{"type":"absolute","value":4216091},{"type":"absolute","value":4216032},{"type":"absolute","value":4215907},{"type":"absolute","value":4216103},{"type":"absolute","value":4215979},{"type":"absolute","value":4215917},{"type":"absolute","value":4216048},{"type":"absolute","value":4215986},{"type":"absolute","value":4216055},{"type":"absolute","value":4215933}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"operand number","index":1,"operand_number":3988292384}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4216117},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlComputeCrc32"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"bytes","bytes":"00000000963007772c610eeeba51099919c46d078ff46a7035a563e9a395649e","description":"crc32_tab"}},"children":[],"locations":[{"type":"absolute","value":4216144},{"type":"absolute","value":4216186}],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":33568}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":60856}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4216193},{"type":"absolute","value":4216139},{"type":"absolute","value":4216180},{"type":"absolute","value":4216151}],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1,"description":"bits in a byte"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"hash data with CRC32/0ea7593c486f4685832f314576a71e20"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"hash data with CRC32/fc547c56da93402588a2dd3cd80f6156"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"nzxor"}},"children":[],"locations":[{"type":"absolute","value":4216193},{"type":"absolute","value":4216139},{"type":"absolute","value":4216180},{"type":"absolute","value":4216151}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"operand number","index":1,"operand_number":3988292384}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"linked against ZLIB":{"meta":{"name":"linked against ZLIB","namespace":"linking/static/zlib","authors":["william.ballenthin@mandiant.com"],"scopes":{"static":"file","dynamic":"file"},"attack":[],"mbc":[{"parts":["Data","Compression Library"],"objective":"Data","behavior":"Compression Library","method":"","id":"C0060"}],"references":[],"examples":["6cc148363200798a12091b97a17181a1"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: linked against ZLIB\n    namespace: linking/static/zlib\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Data::Compression Library [C0060]\n    examples:\n      - 6cc148363200798a12091b97a17181a1\n  features:\n    - or:\n      - string: /deflate .* Copyright/\n      - string: /inflate .* Copyright/\n","matches":[[{"type":"no address"},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/deflate .* Copyright/"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/inflate .* Copyright/"}},"children":[],"locations":[{"type":"file","value":52796}],"captures":{" inflate 1.1.3 Copyright 1995-1998 Mark Adler ":[{"type":"file","value":52796}]}}],"locations":[],"captures":{}}]]}}}
